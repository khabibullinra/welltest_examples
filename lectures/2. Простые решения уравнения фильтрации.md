

#Закон_Дарси #Формула_Дюпюи

Содержание лекции

- [2.1 Стационарные решения](#2.1%20%D0%A1%D1%82%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D1%80%D0%BD%D1%8B%D0%B5%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F)
	- [2.1.1. Радиальное решение с постоянным давлением на внешнем круговом контуре с постоянным давлением](#2.1.1.%20%D0%A0%D0%B0%D0%B4%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%81%20%D0%BF%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%BD%D1%8B%D0%BC%20%D0%B4%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC%20%D0%BD%D0%B0%20%D0%B2%D0%BD%D0%B5%D1%88%D0%BD%D0%B5%D0%BC%20%D0%BA%D1%80%D1%83%D0%B3%D0%BE%D0%B2%D0%BE%D0%BC%20%D0%BA%D0%BE%D0%BD%D1%82%D1%83%D1%80%D0%B5%20%D1%81%20%D0%BF%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%BD%D1%8B%D0%BC%20%D0%B4%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC)
	- [2.1.2. Безразмерные переменные](#2.1.2.%20%D0%91%D0%B5%D0%B7%D1%80%D0%B0%D0%B7%D0%BC%D0%B5%D1%80%D0%BD%D1%8B%D0%B5%20%D0%BF%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5)
	- [2.1.2. Радиальное решение со средним давлением в круговом контуре и постоянным давлением на границе](#2.1.2.%20%D0%A0%D0%B0%D0%B4%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%81%D0%BE%20%D1%81%D1%80%D0%B5%D0%B4%D0%BD%D0%B8%D0%BC%20%D0%B4%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC%20%D0%B2%20%D0%BA%D1%80%D1%83%D0%B3%D0%BE%D0%B2%D0%BE%D0%BC%20%D0%BA%D0%BE%D0%BD%D1%82%D1%83%D1%80%D0%B5%20%D0%B8%20%D0%BF%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%BD%D1%8B%D0%BC%20%D0%B4%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC%20%D0%BD%D0%B0%20%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B5)
	- [2.1.3. Радиальное решение со средним давлением на внешнем круговом контуре с непротекаемой границей](#2.1.3.%20%D0%A0%D0%B0%D0%B4%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%81%D0%BE%20%D1%81%D1%80%D0%B5%D0%B4%D0%BD%D0%B8%D0%BC%20%D0%B4%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC%20%D0%BD%D0%B0%20%D0%B2%D0%BD%D0%B5%D1%88%D0%BD%D0%B5%D0%BC%20%D0%BA%D1%80%D1%83%D0%B3%D0%BE%D0%B2%D0%BE%D0%BC%20%D0%BA%D0%BE%D0%BD%D1%82%D1%83%D1%80%D0%B5%20%D1%81%20%D0%BD%D0%B5%D0%BF%D1%80%D0%BE%D1%82%D0%B5%D0%BA%D0%B0%D0%B5%D0%BC%D0%BE%D0%B9%20%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B5%D0%B9)
	- [2.1.4.  Обобщение для зоны дренирования произвольной формы. Фактор формы Дитца.](#2.1.4.%20%20%D0%9E%D0%B1%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%B4%D0%BB%D1%8F%20%D0%B7%D0%BE%D0%BD%D1%8B%20%D0%B4%D1%80%D0%B5%D0%BD%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9%20%D1%84%D0%BE%D1%80%D0%BC%D1%8B.%20%D0%A4%D0%B0%D0%BA%D1%82%D0%BE%D1%80%20%D1%84%D0%BE%D1%80%D0%BC%D1%8B%20%D0%94%D0%B8%D1%82%D1%86%D0%B0.)
	- [2.1.5. Коэффициент продуктивности. Индикаторная кривая.](#2.1.5.%20%D0%9A%D0%BE%D1%8D%D1%84%D1%84%D0%B8%D1%86%D0%B8%D0%B5%D0%BD%D1%82%20%D0%BF%D1%80%D0%BE%D0%B4%D1%83%D0%BA%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D1%81%D1%82%D0%B8.%20%D0%98%D0%BD%D0%B4%D0%B8%D0%BA%D0%B0%D1%82%D0%BE%D1%80%D0%BD%D0%B0%D1%8F%20%D0%BA%D1%80%D0%B8%D0%B2%D0%B0%D1%8F.)
	- [2.1.6. Суперпозиция для стационарных решений](#2.1.6.%20%D0%A1%D1%83%D0%BF%D0%B5%D1%80%D0%BF%D0%BE%D0%B7%D0%B8%D1%86%D0%B8%D1%8F%20%D0%B4%D0%BB%D1%8F%20%D1%81%D1%82%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D1%80%D0%BD%D1%8B%D1%85%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B9)
- [2.2 Нестационарные решения](#2.2%20%D0%9D%D0%B5%D1%81%D1%82%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D1%80%D0%BD%D1%8B%D0%B5%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F)
	- [2.2.1 Уравнение фильтрации](#2.2.1%20%D0%A3%D1%80%D0%B0%D0%B2%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8)
	- [2.2.2 Решение линейного стока, бесконечно малый радиус скважины, единичный дебит](#2.2.2%20%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D0%BE%D0%B3%D0%BE%20%D1%81%D1%82%D0%BE%D0%BA%D0%B0,%20%D0%B1%D0%B5%D1%81%D0%BA%D0%BE%D0%BD%D0%B5%D1%87%D0%BD%D0%BE%20%D0%BC%D0%B0%D0%BB%D1%8B%D0%B9%20%D1%80%D0%B0%D0%B4%D0%B8%D1%83%D1%81%20%D1%81%D0%BA%D0%B2%D0%B0%D0%B6%D0%B8%D0%BD%D1%8B,%20%D0%B5%D0%B4%D0%B8%D0%BD%D0%B8%D1%87%D0%BD%D1%8B%D0%B9%20%D0%B4%D0%B5%D0%B1%D0%B8%D1%82)
	- [2.2.3. Суперпозиция для нестационарного решения](#2.2.3.%20%D0%A1%D1%83%D0%BF%D0%B5%D1%80%D0%BF%D0%BE%D0%B7%D0%B8%D1%86%D0%B8%D1%8F%20%D0%B4%D0%BB%D1%8F%20%D0%BD%D0%B5%D1%81%D1%82%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D1%80%D0%BD%D0%BE%D0%B3%D0%BE%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F)
	- [2.2.4. Случай для произвольной истории дебитов (линейное изменение дебита) <a class="anchor" id="14.3"></a>](#2.2.4.%20%D0%A1%D0%BB%D1%83%D1%87%D0%B0%D0%B9%20%D0%B4%D0%BB%D1%8F%20%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9%20%D0%B8%D1%81%D1%82%D0%BE%D1%80%D0%B8%D0%B8%20%D0%B4%D0%B5%D0%B1%D0%B8%D1%82%D0%BE%D0%B2%20(%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D0%BE%D0%B5%20%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%B4%D0%B5%D0%B1%D0%B8%D1%82%D0%B0)%20%3Ca%20class=%22anchor%22%20id=%2214.3%22%3E%3C/a%3E)



# 2.1 Стационарные решения
Самые простые решения имеющие практическое значение - стационарные решения.
## 2.1.1. Радиальное решение с постоянным давлением на внешнем круговом контуре с постоянным давлением

В этом разделе рассматривается самая простая модель работы добывающей скважины - радиальная стационарная фильтрация в однородном изотропном пласте с постоянным давлением на круговой границе.

![](attachments/Pasted%20image%2020231003184231.png)

Уравнение фильтрации описывается [законом Дарси](know_base/Закон%20Дарси.md), который может быть приведен к радиальной форме и в таком варианте известен как [Формула Дюпюи](know_base/Формула%20Дюпюи.md).  

В  случае  с поддержанием давления на круговом контуре питания скважины радиусом $r_e$ выражение для радиального притока к скважине имеет вид

$$Q=\frac{kh\left(p_e-p_{wf} \right)}{ 18.41 \mu B \left(\ln{\dfrac{r_e}{r_w}}\right)} \tag{2.1.1.1}$$
в выражении используются практические метрические единицы измерения. 

- $Q$ - объемный дебит скважины в стандартных условиях, ст.м<sup>3</sup>/сут
- $B$ - объемный коэффициент нефти, м<sup>3</sup>/м<sup>3</sup>
- $r_e$ -  радиус зоны дренирования, на котором поддерживается постоянное давление, м
- $r_w$ - радиус скважины, на котором замеряется забойное давление, м
- $p_e$ - давление на внешнем контуре дренирования, атм
- $p_{wf}$ - давление на забое работающей скважины, атм
- $k$ - проницаемость, мД
- $\mu$ - вязкость нефти в зоне дренирования, сП

Выражение (2.1.1.1) позволяет оценить производительность скважины в однородном изотропном пласте круговой формы с постоянным давлением на границе где скважина полностью вскрывает пласт. Его также можно использовать для расчета распределения давления в произвольной точке пласта.

$$p = p_e - \frac{18.41 Q \mu B}{kh} \ln{\dfrac{r_e}{r}}  \tag{2.1.1.2}$$
- $r$ -  расстояние от центра скважины, м
- $p$ - давление на расстоянии $r$, атм

## 2.1.2. Безразмерные переменные

Введем следующие безразмерные переменные:
- безразмерное расстояние
$$r_D = \frac{r}{r_w} \tag{2.1.2.1}$$
- безразмерное давление
$$p_D = \frac{kh}{ 18.41 q_{ref} B \mu} \left( p_e - p \right)  \tag{2.1.2.2}$$
- безразмерный дебит
$$q_D = \frac{q}{q_{ref}} \tag{2.1.2.3}$$

Здесь использованы практические метрические единицы измерения

* $r_w$ - радиус скважины, м
* $r$ - расстояние от центра скважины до точки в пласте, м
* $q_{ref}$ - референсный дебит скважины (дебит на который проводится обезразмеривание)  м$^3$/сут
* $\mu$ - вязкость нефти в пласте, сП
* $B$ - объемный коэффициент нефти, м3/м3
* $p_i$ - начальное давление в пласте, атм
* $p$ - давление на расстоянии $r$, атм

тогда выражение для радиального притока
$$p = p_e - \frac{18.41 Q \mu B}{kh} \ln{\dfrac{r_e}{r}}  \tag{2.1.1.2}$$

можно представить в виде

$$ p_D = q_D \left( \ln r_{eD} - \ln r_D \right) \tag{2.1.2.4}$$
## 2.1.2. Радиальное решение со средним давлением в круговом контуре и постоянным давлением на границе

В  выражение (2.1.1.1) входит значение давления на внешнем контуре $p_e$, которым не всегда бывает удобно пользоваться. В практических случаях значение на контуре трудно оценить, контур зоны дренирования может значительно отличаться от кругового, да и радиус оценить может быть сложно. Удобнее пользоваться средним давлением в зоне дренирования $\bar{p}$, которое может быть оценено по материальному балансу.

В этом случае выражение для дебита примет вид

$$Q=\frac{kh\left( \bar{p}-p_w\right)}{ 18.41 \mu B\left(\ln{\dfrac{r_e}{r_w}} - \dfrac{1}{2} \right)} \tag{2.1.2.1}$$
где 
- $q$ - объемные дебит скважины в рабочих условиях, м<sup>3</sup>/сут
- $r$ -  радиус - расстояние от центра скважины, м
- $r_e$ -  радиус зоны дренирования, на котором поддерживается постоянное давление, м
- $r_w$ - радиус скважины, на котором замеряется забойное давление, м
- $p$ - давление, атм
- $\bar{p}$ - среднее давление в зоне дренирования, атм
- $p_w$ - давление на забое скважины, атм
- $k$ - проницаемость, мД
- $\mu$ - вязкость нефти в зоне дренирования, сП

![](attachments/Pasted%20image%2020230927093815.png)

## 2.1.3. Радиальное решение со средним давлением на внешнем круговом контуре с непротекаемой границей

При условии непротекания давления на границе условия стационарности (неизменности давления) не достигаются. При работе скважины с постоянным дебитом забойное давление будет постоянно снижаться. Однако начиная с некоторого момента, когда влияние скважины достигнет границ - давление в всей области дренирования начнет снижаться равномерно.

![](attachments/Pasted%20image%2020230927221235.png)

Такой режим, при котором забойное давление меняется, но перепад давления $p_e - p_w$ остается постоянным называют псевдо-установившимся режимом работы (pss - pseudo steady state или sss - semi steady state).

$$q=\frac{kh\left( \bar{p}-p_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}} - \dfrac{3}{4} \right)} \tag{2.1.3.1}$$
где
$q$ - объемные дебит скважины в рабочих условиях, м3/сут  
$r$ -  радиус - расстояние от центра скважины, м  
$r_e$ -  радиус зоны дренирования, на котором поддерживается постоянное давление, м  
$r_w$ - радиус скважины, на котором замеряется забойное давление, м  
$p$ - давление, атм  
$p_e$ - давление на внешнем контуре дренирования, атм  
$p_w$ - давление на забое скважины, атм  
$k$ - проницаемость, мД  
$\mu$ - вязкость нефти в зоне дренирования, сП

## 2.1.4.  Обобщение для зоны дренирования произвольной формы. Фактор формы Дитца.

Надо будет добавить сюда формулы для дебита зоне дренирования произвольной формы. А также таблицы с коэффициентами фактора формы Дитца.
## 2.1.5. Коэффициент продуктивности. Индикаторная кривая.

Тут надо будет показать, что стационарный модели широко применяются для управления фондом скважин. Для этого используется коэффициент продуктивности и индикаторные кривые. Их полезно уметь строить.

## 2.1.6. Суперпозиция для стационарных решений

Для расчета распределения давления от влияния нескольких скважин можно использовать принцип суперпозиции, который гласит - что сумма решений линейного уравнения фильтрации также будет решением. 

Давление в произвольной точке пласта $r$ на расстоянии $r_1$ от скважины 1 и расстоянии $r_2$ от скважины 2 можно найти из выражения

$$
P_{res} - P_{r} = 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r_e}{r_1} +S \right] +  18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r_e}{r_2} +S \right]
\tag{2.1.6.1}
$$

Переходя к декартовым координатам, учитывая, что расстояние от скважины с координатами $(x_{well}, y_{well})$ до произвольной точки пласта с координатами $(x,y)$ можно найти по формуле 
$$r=\sqrt{ (x-x_{well})^2 + (y-y_{well})^2 }
\tag{2.1.6.2}$$
можно переписать выражение (2.1.6.1) в виде

$$P_{res} - P_{x,y} = \sum_{i} 18.41\dfrac{ Q_i\mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x-x_{i})^2 + (y-y_{i})^2 }} +S \right]  
\tag{2.1.6.3}$$

В этом выражении пласт предполагается однородным изотропным с постоянными свойствами.

Выражение (2.1.6.3) позволяет рассчитать распределение давления в пласте с рядом скважин для которых известны дебиты. В том числе могут быть найдены и забойные давления скважин. На практике часто интерес представляет задача определения дебитов скважин по известным забойным давлениям. 

Для решения этой задачи можно записать систему уравнений на забойные давления скважин

$$
P_{res} - P_{wf\_i} = \sum_{i} 18.41\dfrac{ Q_i\mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x-x_{i})^2 + (y-y_{i})^2 }} +S \right]  
\tag{2.1.6.4}
$$

можно заметить, что при постоянных параметрах пласта и флюида это система линейных уравнений, где неизвестными являются $Q_i$. Решив эту систему $i$ уравнений можно получить дебиты скважин при известных забойных давлениях.


# 2.2 Нестационарные решения

Для установившегося режима фильтрации давление в пласте не меняется. Для псевдо-установившегося режима постоянным остается перепад давления между пластом и забоем. После запуска, остановки или изменения режима работы скважины эти условия не выполняются. Давление в различных точках пласта может меняться по разному. Такой режим называют неустановившимся, а решения его описывающие нестационарными (зависят от времени).

## 2.2.1 Уравнение фильтрации

Лианеризованное уравнение радиальной фильтрации жидкости в пористой среде можно записать в виде 

$$ 
\frac{\partial p}{\partial t} = 0.00036 \dfrac{k}{\phi \mu c_t} \dfrac{1}{r} \left[ \dfrac{\partial}{\partial r} \left( r \dfrac{ \partial p} {\partial r} \right) \right]  
\tag{2.2.1.1}
$$

Напомним, здесь
* $p$ - давление, атм
* $t$ - время, час
* $k_x$ - проницаемость в направлении движения потока, мД
* $\mu$ - динамическая вязкость, сП
* $\phi$ - пористость, д.е.
* $c_t$ - сжимаемость, 1/атм
* $r$ - расстояние от центра, м

Используя безразмерные переменные 

$$r_D = \frac{r}{r_w} \tag{2.2.1.2}$$
$$t_D = \frac{0.00036 kt}{\phi \mu c_t r_w^2}  \tag{2.2.1.2}$$
$$p_D = \frac{kh}{ 18.41 q_{ref} B \mu} \left( p_i - p \right)  \tag{2.2.1.3}$$
$$q_D = \frac{q}{q_{ref}} \tag{2.2.1.4}$$
Здесь использование единицы измерения СИ.
* $r_w$ - радиус скважины, м
* $r$ - расстояние от центра скважины до точки в пласте, м
* $q_s$ - дебит скважины на поверхности, приведенный к нормальным условиям м3/сут
* $\phi$ - пористость, доли единиц
* $\mu$ - вязкость нефти в пласте, сП
* $B$ - объемный коэффициент нефти, м3/м3
* $p_i$ - начальное давление в пласте, атм
* $p$ - давление на расстоянии $r$, атм
* $c_t$ - общая сжимаемость системы в пласте, 1/атм

уравнение можно представить в виде
$$\frac{\partial p_D}{ \partial t_D} = \dfrac{1}{r_D} \left[ \dfrac{\partial}{\partial r_D} \left( r_D \dfrac{ \partial p_D} {\partial r_D} \right) \right] 
\tag{2.2.1.5}$$

Решение этого уравнения - функция безразмерного давления от безразмерных времени и расстояния $p_D(r_D, t_D)$

## 2.2.2 Решение линейного стока, бесконечно малый радиус скважины, единичный дебит 
Для решения уравнения фильтрации - линейного дифференциального уравнения в частных производных второго порядка необходимо задать начальные и граничные условия.
Самое простое решение можно получить для случая вертикальной скважины бесконечно малого радиуса запускающейся с постоянным дебитом. Условия соответствующие этому случаю можно выразить следующим образом

* начальное условие. До запуска скважины в момент времени  $t_D = 0$ давление в пласте равно начальному во всех точках $p=p_i$
$$t_D < 0, p_D = 0 \tag{2.2.2.1}$$

* условие постоянства дебита на скважине - граничное условие на скважине
$$\lim_{r_D \to 0} {r_D \frac{\partial p_D}{\partial r_D}} = -q_{wD}  \tag{2.2.2.2}$$
радиус скважины предполагается бесконечно малым, знак минус в правой части соответствует добывающей скважине, для которой с ростом расстояния от скважины градиент давления уменьшается. 

* условие на бесконечном расстоянии возмущения от скважине нет
$$r_D = \infty, p_D = 0  \tag{2.2.2.3}$$

В этом случае решение может быть выражено через функцию интегральной экспоненты
$$p_D(r_D,t_D) = - \frac{q_{wD}}{2} Ei \left(- \dfrac{ r_D^2}{4t_d} \right)  \tag{2.2.2.4}$$

где $-Ei(-x)$ - интегральная показательная функция.
![](attachments/Pasted%20image%2020230928214649.png)
$$Ei(x)=-\int\limits_{x}^{\infty}\frac{e^{-t}}{t}\,\mathrm dt=\gamma+\ln|-x|+\sum\limits_{n\ge1}\frac{{-x}^n}{n!\cdot n}, \;  x\in\mathbb R,\; (1)  \tag{2.2.2.5}$$

Где $\gamma = 0.5772$ - константа Эйлера.

На практике пользоваться зависимостью (2.2.2.5) нет необходимости, функции расчета реализованы в библиотеках программ многих языков программирования. Есть такая функция на VBA для использования в Excel (например в [Unifloc VBA](https://github.com/unifloc/unifloc_vba)), есть реализации и для python, например в библиотеке [scipy.special](https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.expi.html).

```python
import scipy.special as sc
# Решение линейного стока для единичного дебита
def pd_ei(td, rd):
    """
    Решение линейного стока уравнения фильтрации
    rd - безразмерное расстояние
    td - безразмерное время
    """
    return -1/2*sc.expi(-rd**2 / 4 / td)
```

Для нас практический интерес будет представлять часть графика для отрицательных значений около нуля (красная линия). Для этой области хорошо работает логарифмическая аппроксимация.

Из выражения (11.8) для малых отрицательных значений аргумента можно получить
$$Ei(-x) = \ln(x) + \gamma
\tag{11.19}$$

где $\gamma = 0.57721566481$ - константа Эйлера

![](attachments/Pasted%20image%2020230928214913.png)

$$p_D(r_D,t_D) = - \frac{q_D}{2} Ei \left(- \dfrac{ r_D^2}{4t_d} \right)  \tag{2.2.2.4}$$
$$p_D(r_D,t_D) = - \frac{q_D}{2} \left[ \ln \left( \dfrac{ r_D^2}{4t_d} \right) +\gamma \right] \tag{2.2.2.4}$$

$$p_D(r_D,t_D) = - q_D \ln r_D  + \frac{q_D}{2} \left[ \ln(4t_D)   +\gamma \right] \tag{2.2.2.4}$$

сравним с 

$$p_D = q_D \left( \ln r_{eD} - \ln r_D \right) $$

тогда 
$$\ln r_{eD} = \frac{1}{2}(\ln(4t_D)+\gamma)$$

## 2.2.3. Суперпозиция для нестационарного решения

Один из самых простых примеров применения суперпозиции - расчет восстановления давления после остановки добывающей скважины.  Предполагаем, что добывающая скважина в однородном изотропном пласте запускается в момент времени `t=0`  c дебитом $q_{wD}$ и работает `t_p_hr` часов, после чего останавливается. После остановки скважины забойное давление растет - и мы получим кривую восстановления давления.

Пусть решение задачи запуска скважины (падения давления) будет $P_D(t_D, r_D)$. Тогда решение для изменения давления при запуске и последующей остановке скважины можно представить в виде (для безразмерного дебита $q_D=\dfrac{q}{q_{wD}}$) 
$$P_{bu.D}(t_D, t_{prod.D}, r_D) = P_D(t_D) - P_D(t_D-t_{prod.D}, r_D) \cdot \mathcal{H}(t_D-t_{prod.D})  \tag{2.2.3.1}$$

где
* $t_D$ - безразмерное время после запуска скважины,
* $t_{prod.D}$ - безразмерное время работы скважины после запуска
* $\mathcal{H}$ - ступенчатая [функция Хевисайда](https://ru.wikipedia.org/wiki/%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F_%D0%A5%D0%B5%D0%B2%D0%B8%D1%81%D0%B0%D0%B9%D0%B4%D0%B0) (в некоторых книгах обозначается как $\theta$)
* $P_D(t_D, r_D)$ - безразмерное давление - решение задачи запуска скважины (падения давления)
* $P_{bu.D}(t_D, t_{prod.D}, r_D)$ - безразмерное давление- решение задачи запуска скважины и последующей остановки скважины

```python
import numpy as np

def pd_build_up(td, td_p, rd):
    """
    расчет давления для запуска и последующей остановки скважины
    td - время после запуска
    td_p - время безразмерное - которое скважина работала до остановки
    rd - расстояние от скважины
    """
    
    # применение функции Хевисайда здесь делает расчет корректным
    # для входных векторов td
    return pd_ei(td, rd) - np.heaviside(td-td_p,1) * pd_ei(td-td_p, rd)
```

Для проведения векторных расчетов в python удобно выражение с использованием функции Хевисайда

$$\mathcal{H} = \begin{cases}0 & x < 0\\\ 1 & x = 0\\\ 1 & x > 0\end{cases}$$

Применение функции Хевисайда позволяет избежать в расчетных функциях применение условных операторов в явном виде для отдельных элементов входных массивов. Это потенциально ускоряет расчет. 

```python
x = np.arange(-2,2,0.01)
y = np.heaviside(x, 1)

plt.plot(x,y)
plt.title('Функция Хевисайда $\mathcal{H}$ ')
```

![](attachments/Pasted%20image%2020231004114127.png)

Результаты расчета изменения безразмерного и размерного давлений на скважинах приведены ниже на рисунках

![](attachments/Pasted%20image%2020231004114254.png)

![](attachments/Pasted%20image%2020231004114317.png)

Результат расчета изменения давления в пласте при запуске и остановке скважин приведены ниже на рисунках (в обычных и полулогарифмических координатах)
![](attachments/Pasted%20image%2020231004114404.png)


Используя принцип суперпозиции, можем выписать выражение для изменения давления на скважине и вокруг нее для произвольного момента времени

$$P_{mr.D}(t_D, r_D) = \sum_i \left[ q_{wD(i)}-q_{wD(i-1)} \right] \cdot p_D\left(t_D-t_{D(i)}, r_D\right)\cdot \mathcal{H}(t_D-t_{D(i)}) \tag{2.2.3.2}$$

где

* $i$ - индекс значения дебита в таблице изменения дебитов
* $q_{wD(i)}$ - безразмерный дебит с номером $i$, который стартует в момент времени $t_i$. Для первого момента времени $i$ дебит следующий перед ним считается равным нулю
* $t_{D(i)}$ - безразмерный момент времени - включения дебита с номером $i$
* $t_{D}$ - безразмерный момент времени для которого проводится расчет
* $\mathcal{H}$ - ступенчатая [функция Хевисайда](https://ru.wikipedia.org/wiki/%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F_%D0%A5%D0%B5%D0%B2%D0%B8%D1%81%D0%B0%D0%B9%D0%B4%D0%B0#:~:text=%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%20%D0%A5%D0%B5%D0%B2%D0%B8%D1%81%D0%B0%D0%B9%D0%B4%D0%B0%20%D1%88%D0%B8%D1%80%D0%BE%D0%BA%D0%BE%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D1%82%D1%81%D1%8F%20%D0%B2,%D0%B4%D0%BB%D1%8F%20%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B8%20%D1%8D%D0%BC%D0%BF%D0%B8%D1%80%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B9%20%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8%20%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F.)
* $p_D\left(t\right)$ - зависимость безразмерного давление от времени - решение задачи запуска скважины с постоянным единичным дебитом
* $P_{mr.D}$ - безразмерное давление $P_{mr.D}(t_D, r_D)$ учитывающее историю изменения дебитов скважины

![](attachments/Pasted%20image%2020231004114859.png)

![](attachments/Pasted%20image%2020231004114916.png)


## 2.2.4. Случай для произвольной истории дебитов (линейное изменение дебита) <a class="anchor" id="14.3"></a>

Для линейно меняющегося дебита во времени (как и для любой другой зависимости) надо решение проинтегрировать по времени (надо бы подробнее расписать - сделать это позже, например как у Щелкачева в основах нестационарной фильтрации на стр 321).

Для линейной зависимости дебита от времени 
$$Q_D = dQ_D \cdot t_D$$
можно получить выражение
$$p_D(r_D,t_D, dQ_D) =-\frac{dQ_D t_D }{2} \left[ \left( 1+ \frac{r_D^2}{4 t_D} \right) Ei \left(- \dfrac{r_D^2}{4t_D} \right) + e^{-\dfrac{r_D^2}{4t_D}} \right] \tag{14.3}$$ 

где $dQ_D$ - скорость изменения дебита.

Для таблично заданных дебитов и времен можно оценить 

$$dQ_{D(i)} = \dfrac{Q_{D(i)}-Q_{D(i-1)}}{t_{D(i)} - t_{D(i-1)} } \tag{14.4}$$

Cравните формулу (14.3) с формулой (9.68) в книге Щелкачева "Основы неустановившейся фильтрации"

Тогда, используя принцип суперпозиции, можем выписать выражение для изменения давления на скважине и вокруг нее для произвольного момента времени

$$P_{mr.D}(t_D, r_D) = \sum_i  p_D\left(t_D-t_{D(i)}, r_D, dQ_{D(i+1)} - dQ_{D(i)}\right)\cdot \mathcal{H}(t_D-t_{D(i)}) \tag{14.5} $$

где

* $i$ - индекс значения дебита в таблице изменения дебитов
* $dQ_{D(i)}$ - изменение безразмерного дебита относительно безразмерного времени (14.4) 
* $t_{D(i)}$ - безразмерный момент времени - включения дебита с номером $i$
* $t_{D}$ - безразмерный момент времени для которого проводится расчет
* $\mathcal{H}$ - ступенчатая [функция Хевисайда](https://ru.wikipedia.org/wiki/%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F_%D0%A5%D0%B5%D0%B2%D0%B8%D1%81%D0%B0%D0%B9%D0%B4%D0%B0#:~:text=%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%20%D0%A5%D0%B5%D0%B2%D0%B8%D1%81%D0%B0%D0%B9%D0%B4%D0%B0%20%D1%88%D0%B8%D1%80%D0%BE%D0%BA%D0%BE%20%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D1%82%D1%81%D1%8F%20%D0%B2,%D0%B4%D0%BB%D1%8F%20%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B8%20%D1%8D%D0%BC%D0%BF%D0%B8%D1%80%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B9%20%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8%20%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F.)
* $p_D\left(t\right)$ - зависимость безразмерного давление от времени - решение задачи запуска скважины с постоянным единичным дебитом
* $P_{mr.D}$ - безразмерное давление $P_{mr.D}(t_D, r_D)$ учитывающее историю изменения дебитов скважины

следует обратить внимание, при суперпозиции скорость изменения дебита вычисляется как $dQ_{D(i+1)} - dQ_{D(i)}$.  при реализации расчета необходимо предусмотреть, чтобы для первого и последнего шага расчет прошел корректно. Для этого можно, например, добавить к массивам дебитов и времени дополнительный значения в начале и в конце массивов соответствующие постоянным значениям дебита. 

Также надо учитывать, что в приведенном выражении массивы должны начинаться со значений $Q_D=0$


![](attachments/Pasted%20image%2020231004115130.png)


Приближенное решение Чекалюка (ПССС)

Как можно использовать стационарное приближение для нестационарной задачи.
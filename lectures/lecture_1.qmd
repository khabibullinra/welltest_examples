---
title: Лекция 1. Введение и простые решения
format: 
  html:
    toc: true
    toc-depth: 3
    toc-expand: 2
    number-sections: true
    section-numbering: 1.1.1
    lang: ru
    embed-resources: true
---

# Введение в дисциплину. Моделирование при исследовании скважин и пластов

## Тезисы для лекции

![Связь исследований и моделирования через процесс принятия решений](images/image.png){width="600"}

1.  Управление месторождениями строится на принятии решений. Принятие решений связано с необратимой тратой ресурсов с целью оптимизации некоторой целевой функции. Чаще всего целевая функция связана с экономикой проекта.
2.  Исследования - инструмент для получения информации для принятия решений. Полезно разделить понятия данные и информация. Данные - то, что записано, информации - данные обработанные в контексте принятия решений.
3.  Исследования основаны на моделях объекта управления. Модель - иструмент получения информации из данных. Также модель - инструмент принятия решений на основе информации. Модель - упрощенное представление реальности.
4.  Модели используемые для принятия решений должны адекватно отражать реальность. Обеспечивается настройкой - адаптацией модели на известные данные и информацию. Такой процесс также можно считать исследованием. Почему?
5.  Принятие решений на основе информации часто осуществляется на основе прогнозов - альтернативных вариантах принятия решений. Модель - инструмент для построения прогнозов.
6.  В узком смысле - исследование скважины, в частности гидродинамические исследования - соответствуют адаптации специализированной модели - решения уравнения фильтрации. Адаптация готовит модель для построения прогнозов и принятия решений.
7.  Понимание всей цепочки создания ценности от данных до принятия решений оказывается полезным, например для обоснования необходимости проведения исследований и оценки ценности информации получаемой в ходе исследований
8.  Кроме понимания всей цепочки важно развитие навыков проведения расчетов - адаптации различных моделей, построения прогнозов с использованием этих моделей. Этому будет посвящена значительная часть курса.

![Схема принятия решений с использованием моделей.](images/paste-1.png)

## Инструменты для моделирования

Работа с моделями в ходе курса может проводиться с использованием различного ПО

-   python для построения аналитических моделей

    Для работы можно использовать jupyter notebook или google colab или любой другой сервис для работы со скважинами. Потребуется освоить базовые библиотеки python - numpy, scipy, matplotlib, mpmath, pandas. Также будут использованы некоторые другие специализированные библиотеки.

-   Макросы MS Excel

    Часть расчетов можно выполнить с использованием макросов MS Excel, например Unifloc VBA (https://github.com/unifloc/unifloc_vba)

-   Гидродинамический симулятор для построения численных моделей

    Базовый вариант - тНавигатор. Версия начиная от 19. Можно будет использовать другие симуляторы - РН-КИМ, Schlumberger eclipse, OPM и другие.

-   Специализированное ПО для анализа ГДИС

    Возможно, что то появится в ходе курса.

# Уравнение фильтрации

Уравнение фильтрации многофазного потока в пористой среде - основная математическая модель пласта используемая в инженерных приложениях. Используется не само уравнение, а разнообразные частные решения, описывающие те или иные ситуации. Наиболее широко известным примером решения уравнения фильтрации, возможно является, численное решение которое строится трехмерными гидродинамическими симуляторами (eclipse, tnavigator и так далее).

Как правило, при выводе уравнения фильтрации используются следующие соотношения:

1.  закон Дарси - определяет линейную зависимость скорости фильтрации от давления

$$ 
u_r=-\frac{k}{\mu}\frac{dp}{dr} 
$$ {#eq-darcy_law_1}

2.  уравнение неразрывности - или закон сохранения массы, показывает что в потоке не могут образовываться разрывы сплошности: $$  
    \frac{1}{r}\frac{\partial\left(r\rho u_r\right)}{\partial r}=-\varphi\frac{\partial p}{\partial t} 
    $$ {#eq-mass_balance_1}

3.  уравнение состояния - задает зависимость плотности флюида от давления: $$   
    c_0=\frac{1}{\rho}\frac{\partial\rho}{\partial p} 
    $$ {#eq-eos_1}

Опираясь на эти соотношения уравнение фильтрации в радиальной форме можно привести к виду для величин СИ.

$$ 
    \frac{\partial ^2 p }{\partial r^2} + \frac{1}{r} \frac{\partial p}{\partial r} = \frac{\varphi \mu c_t}{k} \frac{\partial p}{\partial t} 
$$ {#eq-diff_eq_1}

Здесь используются следующие обозначения:

-   $u_r$ - скорость фильтрации в направлении $r$, м/сек
-   $k$ - проницаемость, м$^2$
-   $\mu$ - вязкость флюида, Па с
-   $p$ - давление, Па
-   $r$ - расстояние, м
-   $\rho$ - плотность флюида, кг/м$^3$
-   $\varphi$ - пористость породы, доли единиц.
-   $c_t$ - общая сжимаемость породы и флюида, 1/Па
-   $t$ - время, сек

Иногда бывает удобно записать уравнение используя другие единицы измерения, например практические метрические - уравнение примет вид:

$$ 
    \frac{\partial ^2 p }{\partial r^2} + \frac{1}{r} \frac{\partial p}{\partial r} = \frac{\varphi \mu c_t}{0.00036 k} \frac{\partial p}{\partial t} 
$$ {#eq-diff_eq_2}

-   $k$ - проницаемость, мД
-   $\mu$ - вязкость флюида, сП
-   $p$ - давление, атм
-   $r$ - расстояние, м
-   $\rho$ - плотность флюида, кг/м$^3$
-   $\varphi$ - пористость породы, доли единиц.
-   $c_t$ - общая сжимаемость породы и флюида, 1/атм
-   $t$ - время, час

Вывод уравнения фильтрации основан на следующих предположениях:

-   пласт однородный и изотропный - пористость и проницаемость одинаковы во всем пласте и во всех направлениях и не зависят от давления
-   добывающая скважина вскрывает весь продуктивный горизонт и обеспечивает радиальный приток к скважине
-   пласт насыщен одним флюидом на всем протяжении
-   температура не меняется в пласте, изотермичность

## Вывод уравнения фильтрации для линейного потока

Уравнение фильтрации основано на трех основных уравнениях:

-   законе сохранения массы
-   зависимости связывающей градиент давления с расходом, в простейшем виде это закон Дарси
-   уравнении состояния - зависимости связывающей сжимаемость флюида (и отчасти среды) и давлением

Выпишем эти уравнения, чтобы разобраться. Ориентируемся в обозначениях и подходе на \[1\]. Особое внимание на данном этапе стоит обратить на размерные коэффициенты в уравнениях. С одной стороны записывая уравнения в \[СИ\] их можно упростить и избежать части сложностей с переводными коэффициентами. С другой стороны во многих источниках переводные коэффициенты интесивно используются и это оказывается удобно при программной реализации алгоритмов. В данном описании ориентируясь на \[1\] приведем перевод коэффициентов в практические метрические единицы.

### Закон сохранения массы

В дифференциальной форме, для потока в направлении $x$

$$
-f \dfrac{\partial \rho q_x}{\partial x} = A \dfrac{\partial(\rho \phi)}{\partial t} 
$$ {#eq-mass_conserv_1}

где

-   $f$ - размерный коэффициент, для практических метрических единиц $f= 0.04167$, для американских промысловых $f = 0.23394$
-   $\rho$ - плотность флюида, кг/м$^3$, lbm/ft$^3$
-   $q_x$ - объемный расход в направлении $x$, м$^3$/сут, bbl/day, учитываем для практических метрических единиц $1$ м$^3$/сут $= 0.04167$ м$^3$/час и для промысловых американских $1$ bbl/day $= 0.23394$ ft$^3$/hr\
-   x - координата, м, ft
-   $\phi$ - пористость, доли единиц
-   $t$ - время, часы
-   $A$ - площадь, м$^2$, ft$^2$

В перечне указаны размерности для промысловых метрических и американских промысловых единиц измерений, там где они отличаются.

Для практических метрических единиц @eq-mass_conserv_1 можно записать в виде 
$$
-0.04167 \dfrac{ \partial (\rho q_x) }{\partial x} = A \dfrac{\partial(\rho \phi)}{\partial t} 
$$ {#eq-mass_conserv_2}

### Закон Дарси

Простейшим вариантом задания зависимости между измением давления и потоком флюида является линейная зависимость - закон Дарси. При этом линейный множитель в зависимости - функция как коллектора (проницаемость), так и свойств флюида (вязкость).

Закон Дарси в направлении $x$. 
$$ 
q_x = -  \dfrac{k_x A}{f\mu} \dfrac{\partial p}{\partial x} 
$$ {#eq-darcy_law_2}

где

-   $f$ - размерный коэффициент, для практических метрических единиц $f= 115.74$, для американских промысловых $f = 887.2$
-   $k_x$ - проницаемость в направлении движения потока, мД
-   $A$ - площадь, м$^2$, ft$^2$
-   $\mu$ - динамическая вязкость, сП
-   $p$ - давление, атм, psi
-   $x$ - координата движения потока, м

В практических метрических единицах измерения @eq-darcy_law_2 будет иметь вид 
$$ 
q_x = -  \dfrac{k_x A}{115.74\mu} \dfrac{\partial p}{\partial x} 
$$ {#eq-darcy_law_3}

Пытаясь проверить корректность вывода переводных коэффициентов необходимо учесть что для единиц измерение СИ получим $f=1$, а необходимые переводные коэффициенты можно записать как:

-   $q$: $1$ \[м$^3$/сек\] = $543439$ \[bbl/day\] = $86400$ \[м$^3$/сут\]
-   $k$: $1$ \[м$^2$\] = $1.01325 \cdot 10^{15}$ \[мД\]
-   $\mu$: $1$ \[Па$\cdot$с\] = $1000$ \[сП\]
-   $p$: $1$ \[Па\] = $0.0001450$ \[psi\] = $0.00000987$ \[атм\]
-   $x$: $1$ \[м\] = $3.28$ \[ft\]
-   $A$: $1$ \[м$^2$\] = $10.76$ \[ft$^2$\]

### Уравнение состояния

В простейшем варианте, который мы будет изучать, предполагается, что сжимаемость постоянна и мала

$$
c_t = c_{formation} + c_{fluid} = const
$$ {#eq-eos_2}

-   $c_t$ - общая сжимаемость (total compressibility)
-   $c_{formation}$ - сжимаемость породы (formation compressibility), $c_{formation} = \dfrac{1}{\phi}\dfrac{\partial \phi}{\partial p}$
-   $c_{fluid}$ - сжимаемость флюида (fluid compressibility), $c_{fluid} = \dfrac{1}{\rho}\dfrac{\partial \rho}{\partial p}$

### Уравнение фильтрации

Подставим выражение для закона Дарси @eq-darcy_law_3 в уравнение мат баланса @eq-mass_conserv_2

$$ 
0.04167 \dfrac{ \partial}{\partial x} { \left[ \rho   \dfrac{k_x A}{115.74\mu} \dfrac{\partial p}{\partial x} \right] } = A \dfrac{\partial(\rho \phi)}{\partial t}  
$$ {#eq-diff_eq_2}

Упрощая @eq-diff_eq_2 получим

$$ 
\frac{\partial (\rho \phi)}{\partial t} = 0.00036 k_x \dfrac{ \partial}{\partial x}\left[ \dfrac{\rho}{\mu}\dfrac{\partial p}{\partial x} \right] 
$$ {#eq-diff_eq_3}

@eq-diff_eq_3 подходит для потока газа. Для жидкости, предполагая малую сжимаемость флюида можно его упростить до вида

$$ 
\frac{\partial p}{\partial t} = 0.00036 \dfrac{k_x}{\phi \mu c_t} \dfrac{ \partial^2 p}{\partial x^2} 
$$ {#eq-diff_eq_4}

Напомним, здесь

-   $p$ - давление, атм
-   $t$ - время, час
-   $k_x$ - проницаемость в направлении движения потока, мД
-   $\mu$ - динамическая вязкость, сП
-   $\phi$ - пористость, д.е.
-   $c_t$ - сжимаемость, 1/атм
-   $x$ - расстояние, м

Приведенное @eq-diff_eq_4 соответствует линейному потоку в пласте. Практический интерес представляет решение для радиального потока

## Вывод уравнения фильтрации для радиального потока

![Схема радиального притока к скважине](images/paste-2.png)

### Закон сохранения массы

Закон сохранения массы или принцип неразрывности можно выразить в радиальной форме следующим соотношением

$$ 
\frac{1}{r}\frac{\partial\left(r\rho u_r\right)}{\partial r}=-\varphi\frac{\partial p}{\partial t}
$$ {#eq-mass_balance_2}

Принцип неразрывности показывает, что для определенного объема пласта, масса флюида которое втекла в контрольный объем пласта минус масса которая вытекла равна массе которая накопилась в объеме.

Сохранение импульса или закон Дарси можно выразить соотношением

$$ 
 u_r=-\frac{k}{\mu}\frac{d^p}{dr}
$$ {#eq-darcy_law_4}

Закон Дарси здесь используется как псевдоустановившаяся аппроксимация обобщенного уравнения сохранения импульса (то есть слагаемым отвечающим за накопление импульса пренебрегаем). Это предположение справедливо если не учитывать возмущения давления в среде двигающиеся со скоростью звука. Все изменения давления описываемые моделью связаны с локальными изменениями градиента давления за счет ламинарного режима потока. Хотя далее в модели будет учтена сжимаемость системы всеми "звуковыми" эффектами в системе мы пренебрегаем.

Поток предполагается горизонтальным, поэтому давление $p$ может быть использовано в качестве потенциала потока, гравитационными силами пренебрегаем.

Комбинируя @eq-mass_balance_2 , @eq-darcy_law_4 получим:

$$ 
\frac{1}{r}\frac{\partial\left( \dfrac{r\rho k}{\mu}\dfrac{\partial p}{dr}\right)}{\partial r}=\varphi\frac{\partial \rho}{\partial t}
$$ {#eq-diff_eq_rad_1}

@eq-diff_eq_rad_1 -- дифференциальное уравнение в частных производных описывающее нестационарный поток однофазного флюида в пористой среде при ламинарном потоке.

Вообще говоря приведенное уравнение является нелинейным, так как плотность $\rho = \rho(p)$ и вязкость $\mu = \mu(p)$ являются функциями давления. Уравнение содержит две зависимые переменные - давление $p$ и плотность $\rho$. Поэтому для его решения необходимо задать еще одно соотношение, каковым может быть уравнение состояния флюида связывающее плотность флюида и давление $\rho = \rho(p)$.

### Флюид постоянной сжимаемости

Нестационарное поведение давления в пласте связано со сжимаемостью системы. При изменении давления в какой то точке, часть флюида сжимается, происходит накопление или отдача флюида, что вызывает задержку в распространении изменения флюида. Несмотря на то, что сжимаемость флюидов и породы малы и во многих случаях ими можно пренебречь, это не верно для пластовых систем для добычи нефти. Большие объемы пласта и флюидов и высокие давления компенсируют малость сжимаемости и требуют ее учета.

Для однофазного флюида разумным является предположение постоянства сжимаемости.

Сжимаемость можно определить как

$$
c=-\frac{1}{V} \left(  \frac{ \partial V}{ \partial p}  \right) 
$$

учтем, что

$$
 \rho = \frac{m}{V} 
$$

тогда получим

$$
c=\frac{1}{\rho} \left(  \frac{ \partial \rho}{ \partial p}  \right) 
$$

Для флюида с постоянной сжимаемостью, проинтегрировав приведенное уравнение можно получить

$$
\rho = \rho_i e^{c(p-p_i)}
$$

где $\rho_i$ плотность флюида при некотором заданном давлении $p_i$

Продифференцировав выражение для плотности по времени получим

$$
c \rho \frac{\partial p}{\partial t} = \frac{\partial \rho}{\partial t}
$$

Подставив это выражение в ранее полученное уравнение фильтрации (@eq-diff_eq_rad_1) получим

$$ 
\frac{1}{r}\frac{\partial\left( \dfrac{r\rho k}{\mu}\dfrac{\partial p}{dr}\right)}{\partial r}=\varphi c \rho \frac{\partial p}{\partial t}  
$$ {#eq-diff_eq_rad_2}

Приведенное дифференциальное уравнение в частных производных все еще нелинейно, поскольку зависит от плотности $\rho$

### Общая сжимаемость

Если пористость не является постоянной величиной и меняется с давлением, тогда слагаемое отвечающее за накопление флюида в пласте можно выразить как

$$
\frac{\partial \varphi \rho}{\partial t} = \varphi \frac{\partial \rho}{\partial t}+ \rho \frac{\partial \varphi }{\partial t} = \varphi c_l \rho \frac{\partial p}{\partial t} + \rho \frac{\partial \varphi }{\partial t}  
$$

где $c_l$ сжимаемость жидкости.

Определим сжимаемость породы как

$$
c_f = \frac{1}{\varphi} \frac{\partial \varphi}{\partial p}
$$

тогда

$$
\frac{\partial \varphi \rho}{\partial t}  = \varphi \rho (c_l + c_f) \frac{\partial p}{\partial t}   
$$

хотя пористость здесь является функцией давления - в первом приближении мы можем считать ее константой равной пористости при некотором среднем давлении в пласте. Это справедливо для маленькой сжимаемости породы, что верно почти всегда.

Уравнение для сжимаемости можно еще уточнить, учтя что в пласте могут находится различные флюиды - вода и нефть с насыщенностями $s_w$ и $s_o$

тогда

$$ 
c_l = s_o c_o + s_w c_w 
$$

тогда можно ввести общую сжимаемость системы

$$
 c_t = c_l + c_f = s_o c_o + s_w c_w  + c_f 
$$

Заметим, что проницаемость k в законе Дарси это не абсолютная проницаемость, но относительная проницаемость по нефти при насыщенности водой соответствующей связанной воде.

$$ 
k= k_o (s_{wc}) 
$$

### Линеаризация уравнения фильтрации

Раскрыв производную в левой части @eq-diff_eq_rad_2 и предположив, что $\dfrac{\partial p}{\partial r}$ мало а следовательно слагаемым $r \rho c_t \left( \dfrac{\partial p}{\partial r} \right)^2$ можно пренебречь, получим линеаризованное уравнения фильтрации

$$
\frac{\partial^2 p}{\partial r^2} + \frac{1}{r} \frac{\partial p}{\partial r}= \frac{\varphi \mu c_t}{k} \frac{\partial p}{\partial t}
$$ {#eq-diff_eq_lin}

## Безразмерные переменные

Часто для анализа уравнений неустановившейся фильтрации используются безразмерные переменные. Мы будем использовать переменные в виде:

$$ 
r_D = \frac{r}{r_w} 
$$

$$ 
t_D = \frac{kt}{\varphi \mu c_t r_w^2}
$$

$$ 
p_D = \frac{2 \pi kh}{q_s B \mu} \left( p_i - p_{wf} \right) 
$$

$$ 
q_D = \frac{q}{q_{ref}} 
$$

Здесь использованы единицы измерения СИ.

-   $q_s$ - дебит скважины на поверхности, приведенный к нормальным условиям м3/с
-   $\varphi$ - пористость, доли единиц
-   $\mu$ - вязкость нефти в пласте, Па с
-   $B$ - объемный коэффициент нефти, м3/м3
-   $p_i$ - начальное давление в пласте, Па
-   $p_{wf}$ - давление забойное, Па
-   $c_t$ - общая сжимаемость системы в пласте, 1/Па

Использование безразмерных переменных позволяет упростить уравнение фильтрации, которое примет вид

$$ 
\frac{\partial p_D}{ \partial t_D} = \frac{1}{r_D} \frac{ \partial{ \left( r_D \dfrac{\partial p_D}{ \partial r_D} \right) } }{ \partial{r_D} } 
$$

$$ 
\frac{\partial p_D}{ \partial t_D} = \dfrac{1}{r_D} \left[ \dfrac{\partial}{\partial r_D} \left( r_D \dfrac{ \partial p_D} {\partial r_D} \right) \right] 
$$

Решение этого уравнения - функция безразмерного давления от безразмерных времени и расстояния $p_D(r_D, t_D)$

Для практических расчетов удобнее бывает использовать безразмерные переменные полученные для практических метрических единиц измерения. 
$$ 
r_D = \frac{r}{r_w} 
$$

$$ 
t_D = \frac{0.00036 kt}{\varphi \mu c_t r_w^2}
$$

$$ 
p_D = \frac{kh}{ 18.4 q_s B \mu} \left( p_i - p_{wf} \right) 
$$

$$ 
q_D = \frac{q}{q_{ref}} 
$$

Здесь использованы практические метрические единицы измерения.

-   $q_s$ - дебит скважины на поверхности, приведенный к нормальным условиям м3/сут
-   $\varphi$ - пористость, доли единиц
-   $\mu$ - вязкость нефти в пласте, сП
-   $B$ - объемный коэффициент нефти, м3/м3
-   $p_i$ - начальное давление в пласте, атм
-   $p_{wf}$ - давление забойное, атм
-   $c_t$ - общая сжимаемость системы в пласте, 1/атм

Уравнение фильтрации для радиального потока в линеаризованном виде можно записать в виде

$$ 
\frac{\partial p}{\partial t} = 0.00036 \dfrac{k}{\phi \mu c_t} \dfrac{1}{r} \left[ \dfrac{\partial}{\partial r} \left( r \dfrac{ \partial p} {\partial r} \right) \right]  
$$

Использование безразмерных переменных позволяет упростить уравнение фильтрации, которое примет вид

$$ 
\frac{\partial p_D}{ \partial t_D} = \dfrac{1}{r_D} \left[ \dfrac{\partial}{\partial r_D} \left( r_D \dfrac{ \partial p_D} {\partial r_D} \right) \right] 
$$

Решение этого уравнения - функция безразмерного давления от безразмерных времени и расстояния $p_D(r_D, t_D)$

### Расчет безразмерных переменных в Unifloc VBA

Несмотря на простоту определений безразмерных переменных их часто приходится применять при проведении расчетов. Поэтому в надстройке Unifloc VBA реализован набор функций расчета безразмерных переменных.

Эти функции начинаются с префикса transient_def.

```         
    transient_def_cd
    transient_def_cs_1atm
    transient_def_td
    transient_def_t_day
    transient_def_pd
    transient_def_pwf_atma
```

Описания функций и из аргументов можно найти в руководстве пользователя Unifloc VBA

# Стационарные решения уравнения фильтрации

Широкое распространение на практике получили стационарные решения уравнения фильтрации. Приведем некоторые из них.

## Решение для постоянного давления на круговой границе

Рассматривается самая простая модель работы добывающей скважины - радиальная стационарная фильтрация в однородном изотропном пласте круговой формы. Скважина находится в центре пласта (@fig-radial_inflow_steady_state_1). На границе пласта поддерживается постоянное давление. Фактически это означает, что через границу пласта идет поток жидкости, уравновешивающий дебит скважины.

Решение можно получить как решения уравнения фильтрации, учитывая стационарность потока

$$  
    \frac{\partial ^2 p }{\partial r^2} + \frac{1}{r} \frac{\partial p}{\partial r} = 0
$$ {#eq-diff_eq_10}


![Схема радиального притока к скважине при наличии постоянного давления на границе](images/paste-3.png){#fig-radial_inflow_steady_state_1}

Или можно получить его непосредственно из закона Дарси, который должен быть приведен к радиальной форме и в таком варианте известен как Формула Дюпюи. Для приведенной конфигурации можно записать закон Дарси в форме.

$$
u_r=\frac{q}{2\pi rh}=\frac{k}{\mu}\frac{dP}{dr}
$$

Проинтегрировав выражение по замкнутому контуру радиуса $r_e$ вокруг скважины получим выражение известное как формула Дюпюи 

$$ 
q=\frac{2\pi kh\left(P_e-P_w\right)}{\mu\left(\ln{\dfrac{r_e}{r_w}}\right)}
$$ {#eq-dupui_1}

В приведенном выражения использованы единицы СИ.

Здесь

- $u_r$ - приведенная скорость фильтрации на расстоянии $r$ от скважины, м/с
- $q$ - объемные дебит скважины в рабочих условиях, м$^3$/с
- $r$ - радиус - расстояние от центра скважины, м
- $r_e$ - радиус зоны дренирования, на котором поддерживается постоянное давление, м
- $r_w$ - радиус скважины, на котором замеряется забойное давление, м
- $P$ - давление, Па
- $P_e$ - давление на внешнем контуре дренирования, Па
- $P_w$ - давление на забое скважины, Па
- $k$ - проницаемость, м$^2$
- $\mu$ - вязкость нефти в зоне дренирования, Па с


На практике часто бывает удобнее пользоваться значениями в практических метрических единицах измерения.

$$
q=\frac{kh\left(P_e-P_w\right)}{ 18.4 \mu\left(\ln{\dfrac{r_e}{r_w}}\right)}
$$ {#eq-dupui_2}

где

- $q$ - объемные дебит скважины в рабочих условиях, м$^3$/сут
- $r$ - радиус - расстояние от центра скважины, м
- $r_e$ - радиус зоны дренирования, на котором поддерживается постоянное давление, м
- $r_w$ - радиус скважины, на котором замеряется забойное давление, м
- $P$ - давление, атм
- $P_e$ - давление на внешнем контуре дренирования, атм
- $P_w$ - давление на забое скважины, атм
- $k$ - проницаемость, мД
- $\mu$ - вязкость нефти в зоне дренирования, сП

Далее если не указано особо будем использовать практические метрические единицы.

### Учет скин-фактора

Скин-фактор — гидродинамический параметр, характеризующий дополнительное фильтрационное сопротивление течению флюидов в околоскважинной зоне пласта, приводящее к изменению добычи (дебита) по сравнению с совершенной (идеальной) скважиной. Скин-фактор может приводить как к снижению дебита (например при загрязнении ПЗС), так и увеличению (образование высокопроводящих каналов в ПЗС).

Концепция скин-фактора получила широкое распространение на практике. Все инженеры-нефтяники знают этот параметр и оперируют им на практике.

Изначально скин-фактор был введен как параметр учитывающий изменение проницаемости (загрязнение) призабойной зоны при расчете производительности скважины. Такое загрязнение может быть вызвано различными причинами:


- проникновением бурового раствора в пласт и блокировкой поровых каналов;
- набуханием глин при контакте с фильтратом бурового раствора;
- химическим осаждением элементов бурового раствора, жидкости глушения или пластовых флюидов в призабойной зоне скважины, например осаждением солей или асфальтенов;
- продвижением песчаных частиц к стволу скважины;
- повреждением породы при перфорации;
- другими причинами.

Для модели загрязненной призабойной зоны величину скин-фактора можно выразить формулой Хокинса \cite{Hawkins_1956}. Скин-фактор для плоскорадиального установившегося потока несжимаемой жидкости:

$$ 
S =\left( \frac{k}{k_s} -1\right)\ ln\frac{r_s}{r_w}
$$ {#eq-skin_hokins}

здесь:

- $k_s$ - проницаемость в загрязненной ПЗП;
- $k$ - однородная проницаемость по всему пласту;
- $r_s$ - радиус загрязненной зоны;
- $r_w$ - радиус скважины.



Концепция скин-фактора оказалась удобной для описания характеристики соединения скважины и пласта и была распространена на другие случаи, когда производительность скважины могла отличаться от производительности идеальной скважины:


- для горизонтальных скважин;
- для скважин вскрывающих пласт под углом;
- для скважин пересеченных трещиной ГРП;
- для скважин вскрытых перфорацией и учета гидравлического сопротивления потока на перфорационных отверстиях;
- другими причинами.

Для многих подобных случаев предположение о радиальном притоке к скважине не верно, но величину скин-фактора используют, так как она позволяет сравнить производительность скважины со сложным заканчиванием с простой вертикальной скважиной. В таких случая говорят о псевдорадиальном скин-факторе - такой величине скин-фактора $S$, которая обеспечила бы такую же производительность для вертикальной скважины полностью вскрывающей пласт.

Для стационарной радиальной модели притока учет скин-фактора приведен к следующим соотношениям: 

$$ 
(P_e - P_{wf}) = \frac{18.41\mu q }{\ k h}(\ln\frac{r_e}{r_w}+S) 
$${#eq-dupui_skin_1}

$$ 
q=\frac{kh\left(P_e-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}} + S\right)}
$${#eq-dupui_skin_2}


### Решение для постоянного давления на круговой границе с учетом среднего давления в области дренирования


![Среднее давление в области дренирования](images/paste-4.png){#fig-radial_inflow_steady_state_2}



В приведенное выражение входит значение давления на контуре, которым не всегда бывает удобно пользоваться. В практических случаях значение на контуре трудно оценить, контур зоны дренирования может значительно отличаться от кругового, да и радиус оценить может быть сложно. Удобнее пользоваться средним давлением в зоне дренирования $\bar{P}$, которое может быть оценено по материальному балансу (смотри рисунок \ref{ris:radial_inflow_steady_state_average_pressure}).

Вывод уравнения фильтрации для постоянного давления на границе с использованием среднего давления 

В этом случае выражение для дебита примет вид 
$$
q=\frac{kh\left( \bar{P}-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}}  - \dfrac{1}{2}+ S \right)}
$$

## Решение для круговой непроницаемой границы

Схема модели радиального притока для условия непротекания на круговой границе приведена на @fig-radial_inflow_steady_state_3


![Схема радиального притока к скважине при наличии непроницаемой границы](images/paste-5.png){#fig-radial_inflow_steady_state_3}

При условии непротекания давления на границе условия стационарности (неизменности давления) не достигаются. При работе скважины с постоянным дебитом забойное давление будет постоянно снижаться. Однако начиная с некоторого момента, когда влияние скважины достигнет границ - давление в всей области дренирования начнет снижаться равномерно (смотри @fig-radial_pss_dynamics).



![Изменение давления на границе и на забое скважины во времени](images/paste-6.png){#fig-radial_pss_dynamics}

Такой режим, при котором забойное давление меняется, но перепад давления $P_e - P_w$ остается постоянным называют псевдо-установившимся режимом работы (pss - pseudo steady state).

Для псевдо-установившегося режима можно записать выражение

$$
q=\frac{kh\left(P_e-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}} - \dfrac{1}{2} + S\right)}
$$ 
где

- $q$ - объемные дебит скважины в рабочих условиях, м3/сут;
- $r$ - радиус - расстояние от центра скважины, м;
- $r_e$ - радиус зоны дренирования, на котором поддерживается постоянное давление, м;
- $r_w$ - радиус скважины, на котором замеряется забойное давление, м;
- $P$ - давление, атм;
- $P_e$ - давление на внешнем контуре дренирования, атм;
- $P_w$ - давление на забое скважины, атм;
- $k$ - проницаемость, мД;
- $\mu$ - вязкость нефти в зоне дренирования, сП.



### Решение для круговой непроницаемой границы с учетом среднего давления в зоне дренирования

Аналогично случаю для постоянного давления на границе можно переписать выражение с использованием среднего давления в области дренирования.

$$
q=\frac{kh\left( \bar{P}-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}} - \dfrac{3}{4}+ S \right)}
$$

Вывод уравнений для псевдо-установившегося режима работы

### Стационарные решения для вертикальной скважины в резервуаре произвольной формы

Здесь уравнения и методы расчета для горизонтальных, наклонно направленных скважин, скважин с ГРП, горизонтальных скважин с МГРП.

$$
    q=\frac{kh\left( \bar{P}-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{2.2458 A}{C_A r_w^2}} + S \right)}
$$

- $q$ - объемные дебит скважины в рабочих условиях, м3/сут;
- $A$ - площадь области дренирования, м$^2$;
- $C_A$ - фактор формы, зависит от формы резервуара и расположения скважины;
- $r_w$ - радиус скважины, на котором замеряется забойное давление, м;
- $\bar{P}$ - среднее давление в области дренирования, атм;
- $P_e$ - давление на внешнем контуре дренирования, атм;
- $P_w$ - давление на забое скважины, атм;
- $k$ - проницаемость, мД;
- $\mu$ - вязкость нефти в зоне дренирования, сП.

![Значения фактора формы](images/paste-7.png){#fig-shape_factors}


%todo -надо переделать рисунок и добавить ссылки на источники

Безразмерное время достижения псевдо-установившегося режима притока, определяемое видом резервуара

$$ 
t_{DApss} = \frac{kt_{pss}}{\varphi \mu c_t A} 
$$



## Формула Дюпюи

Простое решение для задачи стационарного притока к вертикальной скважине в однородном изотропном пласте круговой формы с постоянным давлением на границе имеет вид

$$
    Q=\dfrac{kh}{18.41\mu B} \dfrac{P_{res}-P_{wf}}{\ln \dfrac{r_e}{r_w} + S} 
$$

где:

-   $Q$ - дебит скважины на поверхности, приведённый к нормальным условиям, ст. м$^3$/сут
-   $\mu$ - вязкость нефти в пласте, сП
-   $B$ - объёмный коэффициент нефти, м$^3$/м$^3$
-   $P_{res}$ - пластовое давление или давление на контуре с радиусом $r_e$, атма
-   $P_{wf}$ - давление забойное, атма
-   $k$ - проницаемость, мД
-   $h$ - мощность пласта, м
-   $r_e$ - внешний контур дренирования скважины, м
-   $r_w$ - радиус скважины, м
-   $S$ - скин-фактор скважины, м

Это решение известно как закон Дарси \url{https://ru.wikipedia.org/wiki/Закон_Дарси} или формула Дюпюи.

Выражение можно переписать в виде

$$
    P_{r} = P_{res} - 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r_e}{r} +S \right]
$$

который удобен для расчёта распределения давления в пласте $P_r$ на произвольном расстоянии от скважины $r$. В выражении (2) задано граничное значение давления $p_e$ на контуре $r_e$. Расчёт позволит найти любое значение внутри контура, в том числе и забойное давление $P_{wf}$ на $r=r_w$

Выражение можно переписать 
$$
    P_{r} = P_{wf} + 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r}{r_w} +S \right]
$$

где по известному дебиту и забойному давлению можно найти давление в пласте. При известном пластовом давлении можно оценить радиус контура на котором оно достигается.

![Распределение давления в круговом пласте](images/paste-8.png){#fig-stac_pressure_dist_1}

### Формула Дюпюи в декартовых координатах

Для построения карты распределения давлений в пласте полезно вспомнить, что расстояние от скважины с координатами $(x_{well}, y_{well})$ до произвольной точки пласта с координатами $(x,y)$ можно найти по формуле 
$$
r=\sqrt{ (x-x_{well})^2 + (y-y_{well})^2 }
$$

Тогда выражение для расчета давления в любой точке пласта примет вид

$$
    P_{r} = P_{res} - 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x-x_{well})^2 + (y-y_{well})^2 }} +S \right]
$$

Простой вариант расчета - можно создать пустую матрицу со значениями давления по сетке и перебирая все точки на сетке/матрице рассчитать давления

## Суперпозиция для стационарного решения

### Суперпозиция для нескольких скважин с постоянным дебитом

Для стационарного решения работает принцип суперпозиции - сумма двух решений также будет решением, это позволяет построить карту для нескольких скважин. Давление в любой точке пласта можно найти по формуле

$$
    P_{res} - P_{x,y} =  \sum_{i} 18.41\dfrac{ Q_i\mu B }{kh} \left[ \ln\frac{r_e}{\sqrt{ (x-x_{w.i})^2 + (y-y_{w.i})^2 }} +S \right]
$$

Выражение справедливо только если $\sqrt{ (x-x_{w.i})^2 + (y-y_{w.i})^2 }< r_e$.

### Суперпозиция для нескольких скважин с постоянным забойным давлением

При наличии нескольких скважин можно записать выражение для оценки забойных давлений скважин

$$
P_{res} - P_{wf.j} =  \sum_{i} 18.41\dfrac{ Q_i\mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x_{w.j}-x_{w.i})^2 + (y_{w.j}-y_{w.i})^2 }} +S \right]
$$

Если считать забойные давления $P_{wf.j}$ известными а дебиты скважин $Q_i$ не известными, тогда выражение (6) можно рассматривать как систему линейных алгебраических уравнений вида

$$
AX = B
$$

Где 
$$
A_{[i,j]} = 18.41\dfrac{ \mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x_{w.j}-x_{w.i})^2 + (y_{w.j}-y_{w.i})^2 }} +S \right]
$$

$$
B_{[j]}=P_{res} - P_{wf.j}
$$

такую систему можно решить например с использованием пакета `scipy.linalg`


## Производительность скважины

Уравнение производительности скважины можно записать в виде

$$ 
Q = T \Delta P J_D
$${#eq-well_productivity}

где

- $Q$ - дебит жидкости скважины на поверхности, приведенный к стандартным условиям, м$^3$/сут. 
$$
Q = qB
$$

- $T$ - параметр зависящий от гидропроводности пласта 
$$ 
    T=\dfrac{18.41\mu B q }{\ k h}
$$ {#eq-T}
    
- $\Delta P$ - депрессия на пласт, атм 
$$ 
    \Delta P = \left(P_e-P_w\right)
$${#eq-dP}
    
    
- $J_D$ - безразмерный коэффициент продуктивности скважины, 
$$ 
    J_D = \dfrac{1}{ \left(\ln{\dfrac{r_e}{r_w}} + S\right)}
$${#eq-JD}
    


@eq-well_productivity можно интерпретировать следующим образом. Параметр $T$ отвечает за свойства пласта и флюида на которые трудно повлиять в ходе эксплуатации. Это то, что дала природа в точке где находится скважина. Депрессия $\Delta P$ -- параметр которым можно управлять в ходе эксплуатации регулируя забойное давление. Например за счет установки насоса и задания параметров его работы. На этом параметре должно быть сосредоточено основное внимание при анализе работы скважины. Параметр $J_D$ -- определяет качество соединения скважины с пластом или качество заканчивания. Его мы можем выбирать при строительстве скважины и можем менять в ходе эксплуатации проводя ГТМ, хотя и достаточно большой ценой. Поскольку мы можем влиять на $J_D$ важно понимать, какое оптимальное значение продуктивности можно достичь на конкретной скважине и как его можно изменить.

Задачей гидродинамических исследований является установление величин $T$ и $J_D$, хотя традиционно речь ведется об определении проницаемости $k$ и скин-фактора $S$.

<!--
Продуктивность скважины определяется как: %$$J_{ss} = \frac{q_s}{P_e - P_{wf}} = \frac{k h}{18.41\mu B(\ ln\frac{r_e}{r_w} + S)} $$

Скин фактор и нестационарное решение %$$ P(r, t) = P{t} - \frac {9.205\mu {q_s} B }{k h}(\ ln\frac {k t}{ \phi \mu {c_t} {r^2}} +7.12 + 2S) $$
-->


## Задания для самостоятельной работы

Для совершенствования навыков работы с python выполните следующие задания:

1.  Постройте график распределения давления в пласте для композитного пласта. В композитном пласте на расстоянии $r<r_1$ проницаемость равна $k=k_1$, а для $r>=r_1$, $k=k_2$.

2.  Постройте двумерную тепловую или контурную карту распределения давления в пласте для моделей однородного и композитного пласта.

3.  Рассчитайте среднюю величину давления в круговой области дренирования для однородного пласта. Насколько среднее давление в круговой области дренирования будет отличаться от давления на контуре. Чему будет равен коэффициент $S$ в выражении $Q=\dfrac{kh}{18.41\mu B} \dfrac{P_{res}-P_{wf}}{ln(\dfrac{r_e}{r_w})+S}$ при использовании вместо давления на контуре среднего давления? Постройте график, на котором будет отображаться распределение давления в зоне дренирования и величина среднего давления (в виде линии).

4.  Для примера с несколькими скважинами имитирующими трещину ГРП рассчитайте дебиты скважин таким образом, чтобы забойное давление на всех скважинах было одинаковым. Постройте графики распределения давления в пласте. Постройте график дебитов вдоль "скважины".
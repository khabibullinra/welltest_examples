

# 3.1. Уравнение фильтрации и его решения в пространстве Лапласа <a class="anchor" id="diffusivity-equation"></a>

Рассматривается уравнение фильтрации в безразмерных переменных 

$$\frac{\partial p_D}{ \partial t_D} = \frac{1}{r_D}\left[ \frac{ \partial{}}{ \partial{r_D} }\left( r_D \dfrac{\partial p_D}{ \partial r_D} \right) \right]  
\tag{3.1.1}$$

где введены следующие безразмерные переменные
* $r_D$ - безразмерное расстояние от центра скважины
* $t_D$ - безразмерное время
* $p_D$ - безразмерное давление

Соответствующие определения безразмерных переменных

$$r_D = \frac{r}{r_w} \tag{3.1.2}$$
$$t_D = \frac{0.00036 kt}{\phi \mu c_t r_w^2}  \tag{3.1.3}$$
$$p_D = \frac{kh}{ 18.41 q_{ref} B \mu} \left( p_i - p \right)  \tag{3.1.3}$$
$$q_D = \frac{q}{q_{ref}} \tag{3.1.4}$$

где в свою очередь 
* $q_{ref}$ - дебит скважины на поверхности, приведенный к нормальным условиям, м3/сут
* $\phi$ - пористость, доли единиц
* $\mu$ - вязкость нефти в пласте, сП
* $B$ - объемный коэффициент нефти, м3/м3
* $p_i$ - начальное давление в пласте, атм
* $p$ - давление забойное, атм
* $c_t$ - общая сжимаемость системы в пласте, 1/атм
* $k$ - проницаемость, мД
* $t$ -  время, час
* $r$ - расстояние от центра скважины, м
* $r_w$ - радиус скважины, м

### 3.1.1. Общее решение уравнения фильтрации в пространстве Лапласа <a class="anchor" id="12.1.1"></a>
Решение такого уравнение может быть получено с использованием <a href="https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%B5%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%9B%D0%B0%D0%BF%D0%BB%D0%B0%D1%81%D0%B0"
                        target="_blank" rel="noreferrer noopener">преобразования Лапласа</a>.

$$L \left [ f(t) \right] = \tilde{f}(u) = \int_{0}^{\infty}f(t)e^{-ut}dt 
\tag{3.1.1.1}$$

где $u$ параметр пространства Лапласа соответствующий времени.

Тогда уравнение в пространстве Лапласа преобразуется к виду:

$$u \tilde{p}_D  =  \dfrac{1}{r_D} \left[\dfrac{d}{d r_D} \left(r_D \dfrac{d{\tilde{p}_D}}{d r_D} \right) \right] 
\tag{3.1.1.2}$$

Уравнение (3.1.1.2) известно как  <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8_%D0%91%D0%B5%D1%81%D1%81%D0%B5%D0%BB%D1%8F"> модифицированное уравнение Бесселя </a>. Общее решение этого уравнения можно записать в виде 

$$\tilde{p}_D(u, r_D) = A(u) K_0(r_D \sqrt u) + B(u) I_0(r_D \sqrt u) 
\tag{3.1.1.3}$$

где 
* $u$ - переменная пространства Лапласа, соответствующая времени
* $\tilde{p}_D(u, r_D)$ - изображение давления в пространстве Лапласа
* $K_0, I_0$ - модифицированные функции Бесселя нулевого порядка (могут быть вычислены, например, с использованием реализации в библиотке `scipy.special`)
* $A(u), B(u)$ - произвольные функции, которые могут быть определены при задании начальных и граничных условий

Для модифицированных функций Бесселя нулевого и первого порядка можно записать соотношения

$$\dfrac{dI_0(u)}{du} = I_1(u) \tag{3.1.1.4}$$

$$\dfrac{dK_0(u)}{du} =-K_1(u) \tag{3.1.1.5}$$

Для построения простых решений далее пригодятся некоторые свойства преобразования Лапласа

$$\mathcal{L} \left [ a \right] = \dfrac{a}{u} \tag{3.1.1.6} $$

$$\mathcal{L} \left [ \dfrac{df}{dt} \right] = u \tilde{f}(s) - f(t=0)  \tag{3.1.1.7}$$
Графики функций Бесселя приведены ниже на рисунках
![](Pasted%20image%2020230930081438.png)

## 3.1.2. Решение линейного стока - простейшее решение <a class="anchor" id="12.1.2"></a>
Для построения частного решения необходимо задать начальные и граничные условия. Простейшее решение можно получить задав следующие начальные и граничные условия:

1. Однородное начальное давление
$$p_D(t_D=0, r_D) = 0  \tag{3.1.2.1}$$

2. Граничное условия на бесконечности 

$$\lim_{r_D \to \infty} p_D(r_D, t_D) = 0  \tag{3.1.2.2}$$

в пространстве Лапласа  (3.1.2.2) преобразуется в следующее

$$\lim_{r_D \to \infty} \tilde{p}_D = 0 \tag{3.1.2.3}$$
3. Граничное условие на скважине

$$\lim_{r_D \to r_{wD}} \left[ r_D \dfrac{ \partial p_D(r_D, t_D)}{\partial r_D} \right] = -q_D  \tag{3.1.2.4}$$

в пространстве Лапласа  (3.1.2.4) с учетом выражения (3.1.1.6) преобразуется к

$$\lim_{r_D \to r_{wD}} \left[ r_D \dfrac{ d \tilde{p}_D}{d r_D} \right] = -\dfrac{q_D}{u} \tag{3.1.2.5}$$ 

Граничное условие на скважине (3.1.2.5) можно записать в размерном виде используя определения (3.1.1.3) (3.1.1.4) и сравнить его с законом Дарси в радиальной форме $q_{res} = \dfrac{kh}{18.41 \mu} r \dfrac{dP}{dr}$.

$$\lim_{r \to r_{w}} \left[ r \dfrac{ \partial p(r, t)}{\partial r} \right] = 18.41 \dfrac{qB\mu}{kh} \tag{3.1.2.6}$$

Здесь надо учесть, что $q_{res}$ это дебит из пласта при соответствующих далении и температуре, а $q$ это дебит на поверхности приведенный к стандартным условиям. Они отличаются на объемный коэффициент $B$.

Для построения частного решения необходимо исходя из приведенных условий подобрать значения функций $A(u)$ и $B(u)$ для общего решения (3.1.1.3). 

$$\tilde{p}_D(u, r_D) = A(u) K_0(r_D \sqrt u) + B(u) I_0(r_D \sqrt u) \tag{3.1.1.3}$$


Глядя на поведение функции $I_0$ на бесконечности, понятно что для нашего случая надо положить $B(u) = 0$. 

Тогда решение примет вид

$$\tilde{p}_D = A(u) K_0(r_D \sqrt u) \tag{3.1.2.7}$$

Подставим выражение (3.1.2.7) в граничное условие (3.1.2.5)


$$\lim_{r_D \to r_{wD}} \left[ r_D \dfrac{ d \left( A(u) K_0(r_D \sqrt u)\right)}{d r_D} \right] = -\dfrac{q_D}{u} \tag{3.1.2.8}$$ 

Преобразуем учитывая (3.1.1.7)

$$\lim_{r_D \to r_{wD}} \left[A(u) r_D\sqrt u  K_1(r_D \sqrt u) \right] = \dfrac{q_D}{u} \tag{3.1.2.9}$$

Подставим вместо расстояния - предельное значение

$$A(u) r_{wD} \sqrt u  K_1(r_{wD} \sqrt u)  = \dfrac{q_D}{u} \tag{3.1.2.9}$$

Наконец получим выражение для $A(u)$

$$A(u)  = \dfrac {q_D}{u r_{wD}  \sqrt u  K_1(r_{wD} \sqrt u)} \tag{3.1.2.10}$$

Тогда решение для произвольного радиуса будет иметь вид

$$\tilde{p}_D(u) = \frac{q_D K_0 \left( r_D \sqrt u  \right)}{u r_{wD} \sqrt u  K_1(r_{wD}\sqrt u)} \tag{3.1.2.111}$$
  
при $r_{wD} = 1$ получим 

$$\tilde{p}_D(u) = \frac{q_D K_0 \left( r_D \sqrt u  \right)}{u \sqrt u  K_1(\sqrt u)} \tag{3.1.2.12}$$


при $r_{wD} = 0$, используя свойства функции  
$$\lim_{s \to 0} sK_1(s) = 1 \tag{3.1.2.13}$$ 

получим  $A(u) = \dfrac{1}{u}$

Решение для бесконечно малого радиуса скважины в пространстве Лапласа будет иметь вид

$$\tilde{p}_D(u) = \frac{q_D}{u} K_0 \left( r_D \sqrt u  \right) \tag{3.1.2.14}$$

где 

$K_0$, $K_1$ - <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8_%D0%91%D0%B5%D1%81%D1%81%D0%B5%D0%BB%D1%8F"
                        target="_blank" rel="noreferrer noopener">модифицированные функции Бесселя&nbsp;</a>
                        
Хотя решения в пространстве Лапласа относительно легко получить -- обратная процедура получения решения в исходных координатах на основе решения в пространстве Лапласа оказывается сложнее. Аналитически это не всегда удается сделать, чаще эту процедуру проводят численно. 

Для численного обратного преобразования Лапласа можно, например, использовать библиотеку <a href="https://mpmath.org/doc/current/calculus/inverselaplace.html"> mpmath </a>. Там же можно найти численную реализацию функций Бесселя. Но такой вариант расчета относительно медленный (смотрите пример `00_некоторые_технические_подробности.ipynb` для подробностей). Дальнейшие расчеты будут основаны на `scipy.special` и `anaflow`. 

## 3.1.3. Решение для конечного радиуса скважины 

Решение для конечного радиуса скважины в пространстве Лапласа будет иметь вид

$$\tilde{p}_D(u) = \frac{K_0 \left( r_D \sqrt u  \right)}{u \sqrt u  K_1(\sqrt u)} \tag{3.1.2.15}$$


где 

$K_0$, $K_1$ - <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8_%D0%91%D0%B5%D1%81%D1%81%D0%B5%D0%BB%D1%8F"
                        target="_blank" rel="noreferrer noopener">модифицированные функции Бесселя&nbsp;</a>
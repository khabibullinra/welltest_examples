Широкое распространение на практике получили стационарные решения уравнения фильтрации. Приведем некоторые из них.

\section{Решение для постоянного давления на круговой границе}

Рассматривается самая простая модель работы добывающей скважины - радиальная стационарная фильтрация в однородном изотропном пласте круговой формы. Скважина находится в центре пласта (рис. \ref{ris:radial_inflow_steady_state_1}). На границе пласта поддерживается постоянное давление. Фактически это означает, что через границу пласта идет поток жидкости, уравновешивающий дебит скважины. 

Решение можно получить как решения уравнения фильтрации, учитывая стационарность потока

\begin{equation} \label{eq:diff_eq_1} 
	\frac{\partial ^2 p }{\partial r^2} + \frac{1}{r} \frac{\partial p}{\partial r} = 0
\end{equation}

  

\begin{figure}[h!]
	\begin{center}
		\input{pics/radial_inflow_steady_state_1}
		\caption{Схема радиального притока к скважине при наличии постоянного давления на границе}
		\label{ris:radial_inflow_steady_state_1}
	\end{center}
\end{figure}

Или можно получить его непосредственно из закона Дарси, который должен быть приведен к радиальной форме и в таком варианте известен как Формула Дюпюи.
Для приведенной конфигурации можно записать закон Дарси в форме.

$$u_r=\frac{q}{2\pi rh}=\frac{k}{\mu}\frac{dP}{dr}$$

Проинтегрировав выражение по замкнутому контуру радиуса $r_e$ вокруг скважины получим выражение известное как формула Дюпюи
\marginpar{
	\href{https://qrgo.page.link/BqHRh}{Дюпюи, Жюль } 
	\includegraphics[scale=0.4]{pics/qr_Dupuit.eps} 
}

\begin{equation} \label{eq:dupui_1}
q=\frac{2\pi kh\left(P_e-P_w\right)}{\mu\left(\ln{\dfrac{r_e}{r_w}}\right)}
\end{equation}


В приведенном выражения использованы единицы СИ. 

Здесь 

$u_r$ - приведенная скорость фильтрации на расстоянии $r$ от скважины, м/с 

$q$ - объемные дебит скважины в рабочих условиях, м$^3$/с

$r$ -  радиус - расстояние от центра скважины, м

$r_e$ -  радиус зоны дренирования, на котором поддерживается постоянное давление, м

$r_w$ - радиус скважины, на котором замеряется забойное давление, м

$P$ - давление, Па

$P_e$ - давление на внешнем контуре дренирования, Па

$P_w$ - давление на забое скважины, Па

$k$ - проницаемость, м$^2$

$\mu$ - вязкость нефти в зоне дренирования, Па с

\

На практике часто бывает удобнее пользоваться значениями в практических метрических единицах измерения. 

\begin{equation} \label{eq:dupui_2}
q=\frac{kh\left(P_e-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}}\right)}
\end{equation}

где 

$q$ - объемные дебит скважины в рабочих условиях, м$^3$/сут

$r$ -  радиус - расстояние от центра скважины, м

$r_e$ -  радиус зоны дренирования, на котором поддерживается постоянное давление, м

$r_w$ - радиус скважины, на котором замеряется забойное давление, м

$P$ - давление, атм

$P_e$ - давление на внешнем контуре дренирования, атм

$P_w$ - давление на забое скважины, атм

$k$ - проницаемость, мД

$\mu$ - вязкость нефти в зоне дренирования, сП

\

Далее если не указано особо будем использовать практические метрические единицы.

\section{Учет скин-фактора}

Скин-фактор — гидродинамический параметр, характеризующий дополнительное фильтрационное сопротивление течению флюидов в околоскважинной зоне пласта, приводящее к изменению добычи (дебита) по сравнению с совершенной (идеальной) скважиной. Скин-фактор может приводить как к снижению дебита (например при загрязнении ПЗС), так и увеличению (образование высокопроводящих каналов в ПЗС).

Концепция скин-фактора получила широкое распространение на практике. Все инженеры-нефтяники знают этот параметр и оперируют им на практике. 

Изначально скин-фактор был введен как параметр учитывающий изменение проницаемости (загрязнение) призабойной зоны при расчете производительности скважины. Такое загрязнение может быть вызвано различными причинами:
\begin{itemize}
	\item проникновением бурового раствора в пласт и блокировкой поровых каналов;
	\item набуханием глин при контакте с фильтратом бурового раствора;
	\item химическим осаждением элементов бурового раствора, жидкости глушения или пластовых флюидов в призабойной зоне скважины, например осаждением солей или асфальтенов;
	\item продвижением песчаных частиц к стволу скважины;
	\item повреждением породы при перфорации;
	\item другими причинами.
\end{itemize}	

Для модели загрязненной призабойной зоны величину скин-фактора можно выразить формулой Хокинса \cite{Hawkins_1956}. Скин-фактор для плоскорадиального установившегося потока несжимаемой жидкости:

\begin{equation} \label{eq:skin_hokins}
S =\left( \frac{k}{k_s} -1\right)\ ln\frac{r_s}{r_w}
\end{equation}

здесь:

$k_s$ - проницаемость в загрязненной ПЗП;

$k$ - однородная проницаемость по всему пласту;

$r_s$ - радиус загрязненной зоны;

$r_w$ - радиус скважины.

\

Концепция скин-фактора оказалась удобной для описания характеристики соединения скважины и пласта и была распространена на другие случаи, когда производительность скважины могла отличаться от производительности идеальной скважины:
\begin{itemize}
	\item для горизонтальных скважин;
	\item для скважин вскрывающих пласт под углом;
	\item для скважин пересеченных трещиной ГРП;
	\item для скважин вскрытых перфорацией и учета гидравлического сопротивления потока на перфорационных отверстиях;
	\item другими причинами.
\end{itemize}

Для многих подобных случаев предположение о радиальном притоке к скважине не верно, но величину скин-фактора используют, так как она позволяет сравнить производительность скважины со сложным заканчиванием с простой вертикальной скважиной. В таких случая говорят о псевдорадиальном скин-факторе - такой величине скин-фактора $S$, которая обеспечила бы такую же производительность для вертикальной скважины полностью вскрывающей пласт. 

Для стационарной радиальной модели притока учет скин-фактора приведен к следующим соотношениям:
\begin{equation} \label{eq:dupui_skin_1}
(P_e - P_{wf}) = \frac{18.41\mu q }{\ k h}(\ln\frac{r_e}{r_w}+S) 
\end{equation}


\begin{equation} \label{eq:dupui_skin_2}
q=\frac{kh\left(P_e-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}} + S\right)}
\end{equation}

\section{Производительность скважины}

Уравнение производительности скважины можно записать в виде

\begin{equation} \label{eq:well_productivity}
Q = T \Delta P J_D
\end{equation}

где
\begin{itemize}
	\item $Q$ - дебит жидкости скважины на поверхности, приведенный к стандартным условиям, м$^3$/сут. $$Q = qB$$

	\item $T$ - параметр зависящий от гидропроводности пласта 
	\begin{equation} \label{eq:T}
		T=\dfrac{18.41\mu B q }{\ k h}
	\end{equation}
	
	\item $\Delta P$ - депрессия на пласт, атм 
	\begin{equation} \label{eq:dP}
		\Delta P = \left(P_e-P_w\right)
	\end{equation}
	
	
	\item $J_D$ - безразмерный коэффициент продуктивности скважины, 
	\begin{equation} \label{eq:JD}
		J_D = \dfrac{1}{ \left(\ln{\dfrac{r_e}{r_w}} + S\right)}
	\end{equation}
	

\end{itemize}

Уравнение (\ref{eq:well_productivity}) можно интерпретировать следующим образом. Параметр $T$ отвечает за свойства пласта и флюида на которые трудно повлиять в ходе эксплуатации. Это то, что дала природа в точке где находится скважина. Депрессия $\Delta P$ -- параметр которым можно управлять в ходе эксплуатации регулируя забойное давление. Например за счет установки насоса и задания параметров его работы. На этом параметре должно быть сосредоточено основное внимание при анализе работы скважины. Параметр $J_D$ -- определяет качество соединения скважины с пластом или качество заканчивания. Его мы можем выбирать при строительстве скважины и можем менять в ходе эксплуатации проводя ГТМ, хотя и достаточно большой ценой. Поскольку мы можем влиять на $J_D$ важно понимать, какое оптимальное значение продуктивности можно достичь на конкретной скважине и как его можно изменить. 

Задачей гидродинамических исследований является установление величин $T$ и $J_D$, хотя традиционно речь ведется об определении проницаемости $k$ и скин-фактора $S$. 

%Продуктивность скважины определяется как:
%$$J_{ss} = \frac{q_s}{P_e - P_{wf}} = \frac{k h}{18.41\mu B(\ ln\frac{r_e}{r_w} + S)} $$


%Скин фактор и нестационарное решение
%$$ P(r, t) = P{t} - \frac {9.205\mu {q_s} B }{k h}(\ ln\frac {k t}{ \phi \mu {c_t} {r^2}} +7.12 + 2S) $$

\section{Решение для постоянного давления на круговой границе с учетом среднего давления в области дренирования}

\begin{figure}[h!]
	\begin{center}
		\input{pics/radial_inflow_steady_state_average_pressure}
		\caption{Схема радиального притока к скважине при наличии постоянного давления на границе}
		\label{ris:radial_inflow_steady_state_average_pressure}
	\end{center}
\end{figure}

В приведенное выражение входит значение давления на контуре, которым не всегда бывает удобно пользоваться. В практических случаях значение на контуре трудно оценить, контур зоны дренирования может значительно отличаться от кругового, да и радиус оценить может быть сложно. Удобнее пользоваться средним давлением в зоне дренирования $\bar{P}$, которое может быть оценено по материальному балансу (смотри рисунок \ref{ris:radial_inflow_steady_state_average_pressure}). 



%[[вывод уравнения фильтрации для постоянного давления на границе с использованием среднего давления]]
В этом случае выражение для дебита примет вид
$$q=\frac{kh\left( \bar{P}-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}}  - \dfrac{1}{2}+ S \right)}$$


\section{Решение для круговой непроницаемой границы}

Схема модели радиального притока для условия непротекания на круговой границе приведена на рисунке \ref{ris:radial_inflow_steady_state_2}.

\begin{figure}[h!]
	\begin{center}
		\input{pics/radial_inflow_steady_state_2}
		\caption{Схема радиального притока к скважине при наличии непроницаемой границы}
		\label{ris:radial_inflow_steady_state_2}
	\end{center}
\end{figure}

При условии непротекания давления на границе условия стационарности (неизменности давления) не достигаются. При работе скважины с постоянным дебитом забойное давление будет постоянно снижаться. Однако начиная с некоторого момента, когда влияние скважины достигнет границ - давление в всей области дренирования начнет снижаться равномерно (смотри рисунок \ref{ris:radial_pss_dynamics}). 

\begin{figure}[h!]
	\begin{center}
		\input{pics/radial_pss_dynamics}
		\caption{Изменение давления на границе и на забое скважины во времени}
		\label{ris:radial_pss_dynamics}
	\end{center}
\end{figure}

Такой режим, при котором забойное давление меняется, но перепад давления $P_e - P_w$ остается постоянным называют псевдо-установившимся режимом работы (pss - pseudo steady state). 

Для псевдо-установившегося режима можно записать выражение

$$q=\frac{kh\left(P_e-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}} - \dfrac{1}{2} + S\right)}$$
где 

$q$ - объемные дебит скважины в рабочих условиях, м3/сут;

$r$ -  радиус - расстояние от центра скважины, м;

$r_e$ -  радиус зоны дренирования, на котором поддерживается постоянное давление, м;

$r_w$ - радиус скважины, на котором замеряется забойное давление, м;

$P$ - давление, атм;

$P_e$ - давление на внешнем контуре дренирования, атм;

$P_w$ - давление на забое скважины, атм;

$k$ - проницаемость, мД;

$\mu$ - вязкость нефти в зоне дренирования, сП.

\

\subsection{Решение для круговой непроницаемой границы с учетом среднего давления в зоне дренирования}

Аналогично случаю для постоянного давления на границе можно переписать выражение с использованием среднего давления в области дренирования. 

$$q=\frac{kh\left( \bar{P}-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{r_e}{r_w}} - \dfrac{3}{4}+ S \right)}$$

%[[Вывод уравнений для псевдо-установившегося режима работы]]



\section{Стационарные решения для вертикальной скважины в резервуаре произвольной формы}

Здесь уравнения и методы расчета для горизонтальных, наклонно направленных скважин, скважин с ГРП, горизонтальных скважин с МГРП. 

\begin{equation}
	q=\frac{kh\left( \bar{P}-P_w\right)}{ 18.41 \mu\left(\ln{\dfrac{2.2458 A}{C_A r_w^2}} + S \right)}
\end{equation}

$q$ - объемные дебит скважины в рабочих условиях, м3/сут;

$A$ -  площадь области дренирования, м$^2$;

$C_A$ -  фактор формы, зависит от формы резервуара и расположения скважины;

$r_w$ - радиус скважины, на котором замеряется забойное давление, м;

$\bar{P}$ - среднее давление в области дренирования, атм;

$P_e$ - давление на внешнем контуре дренирования, атм;

$P_w$ - давление на забое скважины, атм;

$k$ - проницаемость, мД;

$\mu$ - вязкость нефти в зоне дренирования, сП.

\

\begin{figure}[h!]
	\centering
	\includegraphics[width= 10cm]{pics/shape_factors.png} 
	\label{fig:shape_factors}
	\caption{Значения фактора формы}
\end{figure}

%todo -надо переделать рисунок и добавить ссылки на источники

Безразмерное время достижения псевдо-установившегося режима притока, определяемое видом резервуара

$$t_{DApss} = \frac{kt_{pss}}{\varphi \mu c_t A} $$

\section{Стационарные решения для скважины с трещиной ГРП}

%todo надо расписать четче и привести решение и для трещины конечной проводимости
Для больших времен скважину с трещиной ГРП можно представить как скважину с увеличенным "эффективным радиусом" $r_{eff}$, или, что эквивалентно, как скважину с отрицательным скин-фактором.

\begin{equation}
	r_{eff} = r_w e^{-S}
\end{equation}

Это верно, только если $x_f << r_e$

Для трещины бесконечной проводимости 

\begin{equation}
	r_{eff} = \frac{x_f}{2}
\end{equation}

тогда 

\begin{equation}
	S = \frac{2r_w}{x_f}
\end{equation}


	
\section{Формула Дюпюи}

Простое решение для задачи стационарного притока к вертикальной скважине в однородном изотропном пласте круговой формы с постоянным давлением на границе имеет вид

\begin{equation}
	Q=\dfrac{kh}{18.41\mu B} \dfrac{P_{res}-P_{wf}}{\ln \dfrac{r_e}{r_w} + S} 
\end{equation}


где: 

- $Q$ - дебит скважины на поверхности, приведённый к нормальным условиям, ст. м$^3$/сут

- $\mu$ - вязкость нефти в пласте, сП

- $B$ - объёмный коэффициент нефти, м$^3$/м$^3$

- $P_{res}$ - пластовое давление или давление на контуре с радиусом $r_e$, атма

- $P_{wf}$ - давление забойное, атма

- $k$ - проницаемость, мД

- $h$ - мощность пласта, м

- $r_e$ - внешний контур дренирования скважины, м

- $r_w$ - радиус скважины, м

- $S$ - скин-фактор скважины, м

Это решение известно как закон Дарси \url{https://ru.wikipedia.org/wiki/Закон_Дарси} или формула Дюпюи.

Выражение можно переписать в виде

\begin{equation}
	P_{r} = P_{res} - 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r_e}{r} +S \right]
\end{equation}

который удобен для расчёта распределения давления в пласте $P_r$ на произвольном расстоянии от скважины $r$.
В выражении (2) задано граничное значение давления $p_e$ на контуре $r_e$. Расчёт позволит найти любое значение внутри контура, в том числе и забойное давление $P_{wf}$ на $r=r_w$

Выражение можно переписать 
\begin{equation}
	P_{r} = P_{wf} + 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r}{r_w} +S \right]
\end{equation}

где по известному дебиту и забойному давлению можно найти давление в пласте. При известном пластовом давлении можно оценить радиус контура на котором оно достигается.

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=12cm]{pics/stac_pressure_dist_1.png}
		\caption{Распределение давления в круговом пласте}
		\label{ris:stac_pressure_dist_1}
	\end{center}
\end{figure}

\subsection{Формула Дюпюи в декартовых координатах}
Для построения карты распределения давлений в пласте полезно вспомнить, что расстояние от скважины с координатами $(x_{well}, y_{well})$ до произвольной точки пласта с координатами $(x,y)$ можно найти по формуле 
$$r=\sqrt{ (x-x_{well})^2 + (y-y_{well})^2 }$$

Тогда выражение для расчета давления в любой точке пласта примет вид

\begin{equation}
	P_{r} = P_{res} - 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x-x_{well})^2 + (y-y_{well})^2 }} +S \right]
\end{equation}

Простой вариант расчета  - можно создать пустую матрицу со значениями давления по сетке и перебирая все точки на сетке/матрице рассчитать давления

\section{Суперпозиция для стационарного решения}

\subsection{Суперпозиция для нескольких скважин с постоянным дебитом} 

Для стационарного решения работает принцип суперпозиции - сумма двух решений также будет решением, это позволяет построить карту для нескольких скважин.
Давление в любой точке пласта можно найти по формуле

\begin{equation}
	P_{res} - P_{x,y} =  \sum_{i} 18.41\dfrac{ Q_i\mu B }{kh} \left[ \ln\frac{r_e}{\sqrt{ (x-x_{w.i})^2 + (y-y_{w.i})^2 }} +S \right]
\end{equation}

Выражение справедливо только если $\sqrt{ (x-x_{w.i})^2 + (y-y_{w.i})^2 }< r_e$.

\subsection{Суперпозиция для нескольких скважин с постоянным забойным давлением}

При наличии нескольких скважин можно записать выражение для оценки забойных давлений скважин


$$
P_{res} - P_{wf.j} =  \sum_{i} 18.41\dfrac{ Q_i\mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x_{w.j}-x_{w.i})^2 + (y_{w.j}-y_{w.i})^2 }} +S \right]
$$

Если считать забойные давления $P_{wf.j}$ известными а дебиты скважин $Q_i$ не известными, тогда выражение (6) можно рассматривать как систему линейных алгебраических уравнений вида

$$AX = B$$

Где
$$
A_{[i,j]} = 18.41\dfrac{ \mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x_{w.j}-x_{w.i})^2 + (y_{w.j}-y_{w.i})^2 }} +S \right]
$$

$$
B_{[j]}=P_{res} - P_{wf.j}
$$

такую систему можно решить например с использованием пакета `scipy.linalg` 

\section{Задания для самостоятельной работы}

Для совершенствования навыков работы с python выполните следующие задания:

1. Постройте график распределения давления в пласте для композитного пласта. В композитном пласте на расстоянии $r<r_1$ проницаемость равна $k=k_1$, а для $r>=r_1$, $k=k_2$. 

2. Постройте двумерную тепловую или контурную карту распределения давления в пласте для моделей однородного и композитного пласта.

3. Рассчитайте среднюю величину давления в круговой области дренирования для однородного пласта. Насколько среднее давление в круговой области дренирования будет отличаться от давления на контуре. Чему будет равен коэффициент $S$ в выражении  $Q=\dfrac{kh}{18.41\mu B} \dfrac{P_{res}-P_{wf}}{ln(\dfrac{r_e}{r_w})+S}$ при использовании вместо давления на контуре среднего давления? Постройте график, на котором будет отображаться распределение давления в зоне дренирования и величина среднего давления (в виде линии).

4. Для примера с несколькими скважинами имитирующими трещину ГРП рассчитайте дебиты скважин таким образом, чтобы забойное давление на всех скважинах было одинаковым. Постройте графики распределения давления в пласте. Постройте график дебитов вдоль "скважины".


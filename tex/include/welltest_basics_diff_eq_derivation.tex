
Уравнение фильтрации многофазного потока в пористой среде - основная математическая модель пласта используемая в инженерных приложениях. Используется не само уравнение, а разнообразные частные решения, описывающие те или иные ситуации. Наиболее широко известным примером решения уравнения фильтрации, возможно является, численное решение которое строится трехмерными гидродинамическими симуляторами (eclipse, tnavigator и так далее)

%[[Вывод уравнения фильтрации]]

Как правило, при выводе уравнения фильтрации используются следующие соотношения:

закон Дарси:  

\begin{equation} \label{eq:darcy_law_1}
	u_r=-\frac{k}{\mu}\frac{dp}{dr} 
\end{equation}

уравнение неразрывности: 
\begin{equation} \label{eq:mass_balance_1} 
	\frac{1}{r}\frac{\partial\left(r\rho u_r\right)}{\partial r}=-\varphi\frac{\partial p}{\partial t} 
\end{equation}

уравнение состояния: 
\begin{equation} \label{eq:eos_1} 
	c_0=\frac{1}{\rho}\frac{\partial\rho}{\partial p} 
\end{equation}

Опираясь на эти соотношения уравнение фильтрации в радиальной форме можно привести к виду для величин СИ.

\begin{equation} \label{eq:diff_eq_1} 
	\frac{\partial ^2 p }{\partial r^2} + \frac{1}{r} \frac{\partial p}{\partial r} = \frac{\varphi \mu c_t}{k} \frac{\partial p}{\partial t} 
\end{equation}

Здесь используются следующие обозначения

$u_r$ - скорость фильтрации в направлении $r$, м/сек

$k$ - проницаемость, м$^2$

$\mu$ - вязкость флюида, Па с

$p$ - давление, Па 

$r$ - расстояние, м 

$\rho$ - плотность флюида, кг/м$^3$

$\varphi$ - пористость породы, доли единиц.

$c_t$ - общая сжимаемость породы и флюида, 1/Па

$t$ - время, сек

Иногда бывает удобно записать уравнение используя другие единицы измерения, например практические метрические - уравнение примет вид:

\begin{equation} \label{eq:diff_eq_2} 
	\frac{\partial ^2 p }{\partial r^2} + \frac{1}{r} \frac{\partial p}{\partial r} = \frac{\varphi \mu c_t}{0.00036 k} \frac{\partial p}{\partial t} 
\end{equation}


$k$ - проницаемость, мД

$\mu$ - вязкость флюида, сП

$p$ - давление, атм 

$r$ - расстояние, м 

$\rho$ - плотность флюида, кг/м$^3$

$\varphi$ - пористость породы, доли единиц.

$c_t$ - общая сжимаемость породы и флюида, 1/атм

$t$ - время, час

\subsection{Вывод уравнения фильтрации}

Вывод уравнения фильтрации основан на следующих предположениях: 
\begin{itemize}
	\item пласт однородный и изотропный - пористость и проницаемость одинаковы во всем пласте и во всех направлениях и не зависят от давления 
	\item добывающая скважина вскрывает весь продуктивный горизонт и обеспечивает радиальный приток к скважине
	\item пласт насыщен одним флюидом на всем протяжении
	\item температура не меняется в пласте, изотермичность
\end{itemize}

Схема притока приведена на рисунке \ref{ris:radial_inflow_scheme}.

\begin{figure}[h!]
	\begin{center}
		\input{pics/radial_inflow_scheme}
		\caption{Схема радиального притока к скважине}
		\label{ris:radial_inflow_scheme}
	\end{center}
\end{figure}

Используются следующие обозначения параметров:

\(h\) - толщина пласта

\(k\) - средняя проницаемость

\(r\) - радиус (расстояние от скважины)

\(r_e\) -  внешний радиус зоны дренирования

\(r_w\) - радиус скважины

\(p\) - давление

\(q\) - объемный расход флюида в рабочих условиях - дебит

\(t\) - время

\(u_r\) - приведенная скорость

\(\varphi\) -  пористость

\(\mu\) - вязкость

\(\rho\) - плотность флюида

\subsubsection{Радиальная модель притока}
Уравнение фильтрации или уравнение движения флюидов основывается на принципах сохранения массы и импульса (количества движения). Для жидкости закон сохранения импульса принимает форму закона Дарси. При этом эффекты турбулентности и отклонения потока от Дарси не учитываются. Они важны для газовых скважин и могут быть введены в уравнение фильтрации отдельно. 

Закон сохранения массы или принцип неразрывности можно выразить в радиальной форме следующим соотношением

\begin{equation} \label{eq:mass_balance_2}
\frac{1}{r}\frac{\partial\left(r\rho u_r\right)}{\partial r}=-\varphi\frac{\partial p}{\partial t}
\end{equation}

Принцип неразрывности показывает, что для определенного объема пласта, масса флюида которое втекла в контрольный объем пласта минус масса которая вытекла равна массе которая накопилась в объеме. 

Сохранение импульса или закон Дарси можно выразить соотношением  


\begin{equation} \label{eq:darcy_law_2}
 u_r=-\frac{k}{\mu}\frac{d^p}{dr}
\end{equation}

Закон Дарси здесь используется как псевдоустановившаяся аппроксимация обобщенного уравнения сохранения импульса (то есть слагаемым отвечающим за накопление импульса пренебрегаем). Это предположение справедливо если не учитывать возмущения давления в среде двигающиеся со скоростью звука. Все изменения давления описываемые моделью связаны с локальными изменениями градиента давления за счет ламинарного режима потока. Хотя далее в модели будет учтена сжимаемость системы всеми "звуковыми" \ эффектами в системе мы пренебрегаем.

Поток предполагается горизонтальным, поэтому давление \( p\) может быть использовано в качестве потенциала потока, гравитационными силами пренебрегаем.

Комбинируя уравнения (\ref{eq:mass_balance_2}), (\ref{eq:darcy_law_2})  получим:

\begin{equation} \label{eq:diff_eq_2}
\frac{1}{r}\frac{\partial\left( \dfrac{r\rho k}{\mu}\dfrac{\partial p}{dr}\right)}{\partial r}=\varphi\frac{\partial \rho}{\partial t}
\end{equation}

Уравнение (\ref{eq:diff_eq_2}) -- дифференциальное уравнение в частных производных описывающее нестационарный поток однофазного флюида в пористой среде при ламинарном потоке. 

Вообще говоря приведенное уравнение является нелинейным, так как плотность $\rho = \rho(p)$ и вязкость $\mu = \mu(p)$ являются функциями давления. Уравнение содержит две зависимые переменные - давление $p$ и плотность $\rho$. Поэтому для его решения необходимо задать еще одно соотношение, каковым может быть уравнение состояния флюида связывающее плотность флюида и давление $\rho = \rho(p)$. 

\subsubsection{Флюид постоянной сжимаемости}
 
Нестационарное поведение давления в пласте связано со сжимаемостью системы. При изменении давления в какой то точке, часть флюида сжимается, происходит накопление или отдача флюида, что вызывает задержку в распространении изменения флюида. Несмотря на то, что сжимаемость флюидов и породы малы и во многих случаях ими можно пренебречь, это не верно для пластовых систем для добычи нефти. Большие объемы пласта и флюидов и высокие давления компенсируют малость сжимаемости и требуют ее учета. 

Для однофазного флюида разумным является предположение постоянства сжимаемости.

Сжимаемость можно определить как 

$$c=-\frac{1}{V} \left(  \frac{ \partial V}{ \partial p}  \right) $$ 

учтем, что

$$ \rho = \frac{m}{V} $$  

тогда получим

$$c=\frac{1}{\rho} \left(  \frac{ \partial \rho}{ \partial p}  \right) $$ 

Для флюида с постоянной сжимаемостью, проинтегрировав приведенное уравнение можно получить 

$$\rho = \rho_i e^{c(p-p_i)}$$

где $\rho_i$ плотность флюида при некотором заданном давлении $p_i$

Продифференцировав выражение для плотность по времени получим 

$$
c \rho \frac{\partial p}{\partial t} = \frac{\partial \rho}{\partial t}
$$

Подставив это выражение в ранее полученное уравнение фильтрации получим 

$$ 
\frac{1}{r}\frac{\partial\left( \dfrac{r\rho k}{\mu}\dfrac{\partial p}{dr}\right)}{\partial r}=\varphi c \rho \frac{\partial p}{\partial t}  
$$

Приведенное дифференциальное уравнение в частных производных все еще нелинейно, поскольку зависит от плотности $\rho$ 



\subsubsection{Общая сжимаемость}
Если пористость не является постоянной величиной и меняется с давлением, тогда  слагаемое отвечающее за накопление флюида в пласте можно выразить как 


$$\frac{\partial \varphi \rho}{\partial t} = \varphi \frac{\partial \rho}{\partial t}+ \rho \frac{\partial \varphi }{\partial t} = \varphi c_l \rho \frac{\partial p}{\partial t} + \rho \frac{\partial \varphi }{\partial t}  $$

где $c_l$ сжимаемость жидкости. 

Определим сжимаемость породы как 

$$c_f = \frac{1}{\varphi} \frac{\partial \varphi}{\partial p}$$

тогда 

$$\frac{\partial \varphi \rho}{\partial t}  = \varphi \rho (c_l + c_f) \frac{\partial p}{\partial t}   $$



хотя пористость здесь является функцией давления - в первом приближении мы можем считать ее константой равной пористости при некотором среднем давлении в пласте. Это справедливо для маленькой сжимаемости породы, что верно почти всегда.

Уравнение для сжимаемости можно еще уточнить, учтя что в пласте могут находится различные флюиды - вода и нефть с насыщенностями  $s_w$ и $s_o$

тогда 

$$ c_l = s_o c_o + s_w c_w $$

тогда можно ввести общую сжимаемость системы 

$$ c_t = c_l + c_f = s_o c_o + s_w c_w  + c_f $$ 

Заметим, что проницаемость k в законе Дарси это не абсолютная проницаемость, но относительная проницаемость по нефти при насыщенности водой соответствующей связанной воде.  

$$ k= k_o (s_{wc}) $$

\subsubsection{Линеаризация уравнения фильтрации}

Раскрыв производную в левой части уравнения и предположив, что $\dfrac{\partial p}{\partial r}$ мало а следовательно слагаемым  $ r \rho c_t \left( \dfrac{\partial p}{\partial r} \right)^2 $ можно пренебречь, что приведет к линеаризации уравнения фильтрации

\begin{equation} \label{eq:diff_eq_lin}
\frac{\partial^2 p}{\partial r^2} + \frac{1}{r} \frac{\partial p}{\partial r}= \frac{\varphi \mu c_t}{k} \frac{\partial p}{\partial t}
\end{equation}


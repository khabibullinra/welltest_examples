%!TEX TS-program = xelatex

\documentclass[oneside, openany]{memoir}


%\documentclass[a4paper,12pt]{article}

\include{settings.tex}

\usepackage{markdown}

\author{Хабибуллин Р.А.}
\title{Простые решения уравнения фильтрации}
\date{\today}

\input{biblio/biblatex}

\begin{document} % конец преамбулы, начало документа
	
	\maketitle
	
	\chapter{Простые решения уравнения фильтрации}
	
	\section{Уравнение фильтрации}
	
	\input{include/welltest_basics_diff_eq_derivation}
	
	
	\section{Стационарные решения уравнения фильтрации}
	
	\input{include/welltest_basics_steady_state_solutions}
	
	
	\section{Формула Дюпюи}
	
	Простое решение для задачи стационарного притока к вертикальной скважине в однородном изотропном пласте круговой формы с постоянным давлением на границе имеет вид
	
	\begin{equation}
		Q=\dfrac{kh}{18.41\mu B} \dfrac{P_{res}-P_{wf}}{\ln \dfrac{r_e}{r_w} + S} 
	\end{equation}
	
	
	где: 
	
	- $Q$ - дебит скважины на поверхности, приведенный к нормальным условиям, ст. м$^3$/сут
	
	- $\mu$ - вязкость нефти в пласте, сП
	
	- $B$ - объемный коэффициент нефти, м$^3$/м$^3$
	
	- $P_{res}$ - пластовое давление или давление на контуре с радиусом $r_e$, атма
	
	- $P_{wf}$ - давление забойное, атма
	
	- $k$ - проницаемость, мД
	
	- $h$ - мощность пласта, м
	
	- $r_e$ - внешний контур дренирования скважины, м
	
	- $r_w$ - радиус скважины, м
	
	- $S$ - скин-фактор скважины, м
	
	Это решение известно как закон Дарси \url{https://ru.wikipedia.org/wiki/Закон_Дарси} или формула Дюпюи.
	
	Выражение можно переписать в виде
	
	\begin{equation}
		P_{r} = P_{res} - 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r_e}{r} +S \right]
	\end{equation}
	
	который удобен для расчета распределения давления в пласте $P_r$ на произвольном расстоянии от скважины $r$.
	В выражении (2) задано граничное значение давления $p_e$ на контуре $r_e$. Расчет позволит найти любое значение внутри контура, в том числе и забойное давление $P_{wf}$ на $r=r_w$
	
	Выражение можно переписать 
	\begin{equation}
	P_{r} = P_{wf} + 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r}{r_w} +S \right]
	\end{equation}
	
	где по известному дебиту и забойному давлению можно найти давление в пласте. При известном пластовом давлении можно оценить радиус контура на котором оно достигается.
	
	\subsection{Формула Дюпюи в декартовых координатах}
	Для построения карты распределения давлений в пласте полезно вспомнить, что расстояние от скважины с координатами $(x_{well}, y_{well})$ до произвольной точки пласта с координатами $(x,y)$ можно найти по формуле 
	$$r=\sqrt{ (x-x_{well})^2 + (y-y_{well})^2 }$$
	
	Тогда выражение для расчета давления в любой точке пласта примет вид
	
	\begin{equation}
		P_{r} = P_{res} - 18.41\dfrac{ Q\mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x-x_{well})^2 + (y-y_{well})^2 }} +S \right]
	\end{equation}
	
	Простой вариант расчета  - можно создать пустую матрицу со значениями давления по сетке и перебирая все точки на сетке/матрице рассчитать давления
	
	\subsection{Суперпозиция для нескольких скважин с постоянным дебитом} 
	
	Для стационарного решения работает принцип суперпозиции - сумма двух решений также будет решением, это позволяет построить карту для нескольких скважин.
	Давление в любой точке пласта можно найти по формуле
	
	\begin{equation}
	P_{res} - P_{x,y} =  \sum_{i} 18.41\dfrac{ Q_i\mu B }{kh} \left[ \ln\frac{r_e}{\sqrt{ (x-x_{w.i})^2 + (y-y_{w.i})^2 }} +S \right]
	\end{equation}
	
	Выражение справедливо только если $\sqrt{ (x-x_{w.i})^2 + (y-y_{w.i})^2 }< r_e$.
	
	\subsection{Суперпозиция для нескольких скважин с постоянным забойным давлением}
	
	При наличии нескольких скважин можно записать выражение для оценки забойных давлений скважин
	
	
	$$
	P_{res} - P_{wf.j} =  \sum_{i} 18.41\dfrac{ Q_i\mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x_{w.j}-x_{w.i})^2 + (y_{w.j}-y_{w.i})^2 }} +S \right]
	$$
	
	Если считать забойные давления $P_{wf.j}$ известными а дебиты скважин $Q_i$ не известными, тогда выражение (6) можно рассматривать как систему линейных алгебраических уравнений вида
	
	$$AX = B$$
	
	Где
	$$
	A_{[i,j]} = 18.41\dfrac{ \mu B }{kh} \left[ \ln\dfrac{r_e}{\sqrt{ (x_{w.j}-x_{w.i})^2 + (y_{w.j}-y_{w.i})^2 }} +S \right]
	$$
	
	$$
	B_{[j]}=P_{res} - P_{wf.j}
	$$
	
	такую систему можно решить например с использованием пакета `scipy.linalg` 
	
	\subsection{Задания для самостоятельной работы}
	
	Для совершенствования навыков работы с python выполните следующие задания:
	
	1. Постройте график распределения давления в пласте для композитного пласта. В композитном пласте на расстоянии $r<r_1$ проницаемость равна $k=k_1$, а для $r>=r_1$, $k=k_2$. 
	2. Постройте двумерную тепловую или контурную карту распределения давления в пласте для моделей однородного и композитного пласта.
	3. Рассчитайте среднюю величину давления в круговой области дренирования для однородного пласта. Насколько среднее давление в круговой области дренирования будет отличаться от давления на контуре. Чему будет равен коэффициент $S$ в выражении  $Q=\dfrac{kh}{18.41\mu B} \dfrac{P_{res}-P_{wf}}{ln(\dfrac{r_e}{r_w})+S}$ при использовании вместо давления на контуре среднего давления? Постройте график, на котором будет отображаться распределение давления в зоне дренирования и величина среднего давления (в виде линии).
	4. Для примера с несколькими скважинами имитирующими трещину ГРП рассчитайте дебиты скважин таким образом, чтобы забойное давление на всех скважинах было одинаковым. Постройте графики распределения давления в пласте. Постройте график дебитов вдоль "скважины".
	
	\section{Решение линейного стока}
	
	Уравнение фильтрации для радиального потока в линеаризованном виде можно записать в виде
	
	\begin{equation}
		\frac{\partial p}{\partial t} = 0.00036 \dfrac{k}{\phi \mu c_t} \dfrac{1}{r} \left[ \dfrac{\partial}{\partial r} \left( r \dfrac{ \partial p} {\partial r} \right) \right]		
	\end{equation} 

	
	Напомним, здесь
	
	- $p$ - давление, атм
	
	- $t$ - время, час
	
	- $k$ - проницаемость в направлении движения потока, мД
	
	- $\mu$ - динамическая вязкость, сП
	
	- $\phi$ - пористость, д.е.
	
	- $c_t$ - сжимаемость, 1/атм
	
	- $r$ - расстояние от центра, м
	
	Часто для анализа уравнений неустановившейся фильтрации используются безразмерные переменные. Мы будем использовать переменные в виде:
	
	$$ r_D = \frac{r}{r_w}  $$
	$$ t_D = \frac{0.00036 kt}{\phi \mu c_t r_w^2}  $$
	$$ p_D = \frac{kh}{ 18.41 q_s B \mu} \left( p_i - p \right)   $$
	
	Здесь использование единицы измерения СИ.
	- $r_w$ - радиус скважины, м
	
	- $r$ - расстояние от центра скважины до точки в пласте, м
	
	- $q_s$ - дебит скважины на поверхности, приведенный к нормальным условиям м3/сут
	
	- $\phi$ - пористость, доли единиц
	
	- $\mu$ - вязкость нефти в пласте, сП
	
	- $B$ - объемный коэффициент нефти, м3/м3
	
	- $p_i$ - начальное давление в пласте, атм
	
	- $p$ - давление на расстоянии $r$, атм
	
	- $c_t$ - общая сжимаемость системы в пласте, 1/атм
	
	Использование безразмерных переменных позволяет упростить уравнение фильтрации, которое примет вид
	
	$$ 
	\frac{\partial p_D}{ \partial t_D} = \dfrac{1}{r_D} \left[ \dfrac{\partial}{\partial r_D} \left( r_D \dfrac{ \partial p_D} {\partial r_D} \right) \right] 
	$$
	
	Решение этого уравнения - функция безразмерного давления от безразмерных времени и расстояния $p_D(r_D, t_D) $
	
	\subsection{Решение линейного стока} 
	
	Для решения уравнения фильтрации - линейного дифференциального уравнения в частных производных второго порядка необходимо задать начальные и граничные условия.
	Самое простое решение можно получить для случая вертикальной скважины бесконечно малого радиуса запускающейся с постоянным дебитом. Условия соответствующие этому случаю можно выразить следующим образом
	
	* начальное условие. До запуска скважины в момент времени  $t_D = 0$ давление в пласте равно начальному во всех точках $p=p_i$
	$$ t_D < 0, p_D = 0$$
	
	* условие постоянства дебита на скважине - граничное условие на скважине
	$$ \lim_{r_D \to 0} {r_D \frac{\partial p_D}{\partial r_D}} = -1 $$
	
	* условие на бесконечном расстоянии возмущения от скважине нет
	$$ r_D = \infty, p_D = 0 $$
	
	В этом случае решение может быть выражено через функцию интегральной экспоненты
	$$ p_D(r_D,t_D) = - \frac{1}{2} Ei \left(- \dfrac{ r_D^2}{4t_d} \right) $$
	
	где -Ei(-x) - интегральная показательная функция.
	
	Решение в размерных переменных можно записать как
	$$
	p\left(r,t\right)=p_i-\frac{18.41q_sB\mu}{kh}\left(-\frac{1}{2} Ei \left(-\frac{\varphi\mu c_tr^2}{0.00144kt}\right)\right) 
	$$
	
	
	Решение с интегральной экспонентой может быть заменено приблеженным решением с использованием логарифма 
	
	$$ 
	p_D(r_D,t_D) = - \frac{1}{2} \ln \left( \dfrac{ r_D^2}{4t_d} \right) - \frac{1}{2}\gamma 
	$$
	
	где $\gamma = 0.57721566481$ - константа Эйлера
	
	на графике от времени в полулогарифмических координатах логарифмическое приближение выглядит как кривая с наклоном $0.5$
	
	%\insertbibliofull
	\printbibliography
\end{document}
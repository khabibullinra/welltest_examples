%!TEX TS-program = xelatex

\documentclass[oneside, openany]{memoir}


%\documentclass[a4paper,12pt]{article}

\include{include/settings.tex}

\usepackage{markdown}

\author{версия 0.2}
\title{Простые решения уравнения фильтрации}
\date{\today}

\input{biblio/biblatex}

\begin{document} % конец преамбулы, начало документа
	
	\maketitle
	
	\chapter{Простые решения уравнения фильтрации}
	
	\section{Уравнение фильтрации}
	
	\input{include/welltest_basics_diff_eq_derivation}
	
	
	\section{Стационарные решения уравнения фильтрации}
	
	\input{include/welltest_basics_steady_state_solutions}
	
	
	
	\section{Нестационарные решения уравнения фильтрации}
	
	\input{include/welltest_basics_transient_solutions}
	

	
	\section{Решение линейного стока}
	
	Уравнение фильтрации для радиального потока в линеаризованном виде можно записать в виде
	
	\begin{equation}
		\frac{\partial p}{\partial t} = 0.00036 \dfrac{k}{\phi \mu c_t} \dfrac{1}{r} \left[ \dfrac{\partial}{\partial r} \left( r \dfrac{ \partial p} {\partial r} \right) \right]		
	\end{equation} 

	
	Напомним, здесь
	
	- $p$ - давление, атм
	
	- $t$ - время, час
	
	- $k$ - проницаемость в направлении движения потока, мД
	
	- $\mu$ - динамическая вязкость, сП
	
	- $\phi$ - пористость, д.е.
	
	- $c_t$ - сжимаемость, 1/атм
	
	- $r$ - расстояние от центра, м
	
	Часто для анализа уравнений неустановившейся фильтрации используются безразмерные переменные. Мы будем использовать переменные в виде:
	
	$$ r_D = \frac{r}{r_w}  $$
	$$ t_D = \frac{0.00036 kt}{\phi \mu c_t r_w^2}  $$
	$$ p_D = \frac{kh}{ 18.41 q_s B \mu} \left( p_i - p \right)   $$
	
	Здесь использование единицы измерения СИ.
	- $r_w$ - радиус скважины, м
	
	- $r$ - расстояние от центра скважины до точки в пласте, м
	
	- $q_s$ - дебит скважины на поверхности, приведенный к нормальным условиям м3/сут
	
	- $\phi$ - пористость, доли единиц
	
	- $\mu$ - вязкость нефти в пласте, сП
	
	- $B$ - объемный коэффициент нефти, м3/м3
	
	- $p_i$ - начальное давление в пласте, атм
	
	- $p$ - давление на расстоянии $r$, атм
	
	- $c_t$ - общая сжимаемость системы в пласте, 1/атм
	
	Использование безразмерных переменных позволяет упростить уравнение фильтрации, которое примет вид
	
	$$ 
	\frac{\partial p_D}{ \partial t_D} = \dfrac{1}{r_D} \left[ \dfrac{\partial}{\partial r_D} \left( r_D \dfrac{ \partial p_D} {\partial r_D} \right) \right] 
	$$
	
	Решение этого уравнения - функция безразмерного давления от безразмерных времени и расстояния $p_D(r_D, t_D) $
	
	\subsection{Решение линейного стока} 
	
	Для решения уравнения фильтрации - линейного дифференциального уравнения в частных производных второго порядка необходимо задать начальные и граничные условия.
	Самое простое решение можно получить для случая вертикальной скважины бесконечно малого радиуса запускающейся с постоянным дебитом. Условия соответствующие этому случаю можно выразить следующим образом
	
	* начальное условие. До запуска скважины в момент времени  $t_D = 0$ давление в пласте равно начальному во всех точках $p=p_i$
	$$ t_D < 0, p_D = 0$$
	
	* условие постоянства дебита на скважине - граничное условие на скважине
	$$ \lim_{r_D \to 0} {r_D \frac{\partial p_D}{\partial r_D}} = -1 $$
	
	* условие на бесконечном расстоянии возмущения от скважине нет
	$$ r_D = \infty, p_D = 0 $$
	
	В этом случае решение может быть выражено через функцию интегральной экспоненты
	$$ p_D(r_D,t_D) = - \frac{1}{2} Ei \left(- \dfrac{ r_D^2}{4t_d} \right) $$
	
	где -Ei(-x) - интегральная показательная функция.
	
	Решение в размерных переменных можно записать как
	\begin{equation}
	p\left(r,t\right)=p_i-\frac{18.41q_sB\mu}{kh}\left(-\frac{1}{2} Ei \left(-\frac{\varphi\mu c_tr^2}{0.00144kt}\right)\right) 
	\end{equation}
	
	
	Решение с интегральной экспонентой может быть заменено приближенным решением с использованием логарифма 
	
	$$ 
	p_D(r_D,t_D) = - \frac{1}{2} \ln \left( \dfrac{ r_D^2}{4t_d} \right) - \frac{1}{2}\gamma 
	$$
	
	где $\gamma = 0.57721566481$ - константа Эйлера
	
	на графике от времени в полулогарифмических координатах логарифмическое приближение выглядит как кривая с наклоном $0.5$
	
	\subsection{Расчет кривой восстановления давления}
	
	Один из самых простых примеров применения суперпозиции. Предполагаем, что добывающая скважина в однородном изотропном пласте запускается в момент времени $t=0$ и работает $t_{p}$ часов, после чего останавливается. После остановки скважины забойное давление растет - и мы получим кривую восстановления давления.
	
	Пусть решение задачи запуска скважины (падения давления) будет $P_D(t_D, r_D)$. Тогда решение для изменения давления при запуске и последующей остановки скважины можно представить в виде 
	
	\begin{equation}
	P_{bu.D}(t_D, t_{prod.D}, r_D) = P_D(t_D) - P_D(t_D-t_{prod.D}, r_D) \cdot \mathcal{H}(t_D-t_{prod.D}) 
	\end{equation}
	
	где
	
	- $t_D$ - безразмерное время после запуска скважины,
	
	- $t_{prod.D}$ - безразмерное время работы скважины после запуска
	
	- $\mathcal{H}$ - ступенчатая функция Хевисайда \url{https://ru.wikipedia.org/wiki/Функция_Хевисайда} (в некоторых книгах обозначается как $\theta$)
	
	- $P_D(t_D, r_D)$ - безразмерное давление - решение задачи запуска скважины (падения давления)
	
	- $P_{bu.D}(t_D, t_{prod.D}, r_D)$ - безразмерное давление- решение задачи запуска  и последующей остановки скважины
	
	Для проведения векторных расчетов в python удобно выражение с использованием функции Хевисайда
	
	$$ \mathcal{H} = \begin{cases}0 & x < 0\\1 & x = 0\\1 & x > 0\end{cases}$$
	
	Применение функции Хевисайда позволяет избежать в расчетных функциях условных операторов в явном виде для отдельных элементов входных массивов. Это потенциально ускоряет расчет. 
	
	
	\subsection{Решение для произвольной истории дебитов (ступенчатое изменение дебита)} 
	
	Для расчета изменения давления при переменном дебите введем произвольное референсное значение дебита $ q_{ref} $ (например первое не нулевое значение дебита при запуске скважины). Используем это значение для определения безразмерного давления.
	$$ p_D = \frac{kh}{ 18.41 q_{ref} B \mu} \left( p_i - p \right) $$
	
	и безразмерного дебита 
	
	$$q_D = \frac{q}{q_{ref}} $$
	
	Тогда, используя принцип суперпозиции, можем выписать выражение для изменения давления на скважине и вокруг нее для произвольного момента времени
	
	\begin{equation}
	P_{mr.D}(t_D, r_D) = \sum_i \left[ q_{D(i)}-q_{D(i-1)} \right] \cdot p_D\left(t_D-t_{D(i)}, r_D\right)\cdot \mathcal{H}(t_D-t_{D(i)}) \tag{7} 
	\end{equation}
	
	где
	
	- $i$ - индекс значения дебита в таблице изменения дебитов
	
	- $q_{D(i)}$ - безразмерный дебит с номером $i$, который стартует в момент времени $t_i$. Для первого момента времени $i$ дебит следующий перед ним считается равным нулю
	
	- $t_{D(i)}$ - безразмерный момент времени - включения дебита с номером $i$
	
	- $t_{D}$ - безразмерный момент времени для которого проводится расчет
	
	- $\mathcal{H}$ - ступенчатая функция Хевисайда
	
	- $p_D\left(t\right)$ - зависимость безразмерного давление от времени - решение задачи запуска скважины с постоянным единичным дебитом
	
	- $P_{mr.D} $ - безразмерное давление $P_{mr.D}(t_D, r_D)$ учитывающее историю изменения дебитов скважины
	
	\subsection{Случай для произвольной истории дебитов (линейное изменение дебита)}
	
	для линейно меняющегося дебита $dq_D t_D$ решение можно представить как интеграл
	
	$$
	p_D = \int_0^{t_D}{- \frac{dq_D}{2} Ei \left(- \dfrac{ r_D^2}{4t_d} \right) dt_D}
	$$
	
	
	
	Для линейно меняющегося дебита во времени (как и для любой другой зависимости) надо решение проинтегрировать по времени (надо бы подробнее расписать - сделать это позже, например как у Щелкачева в основах нестационарной фильтрации на стр 321).
	
	Для линейной зависимости дебита от времени 
	$$
	Q_D = dQ_D \cdot t_D 
	$$
	можно получить выражение
	$$
	p_D(r_D,t_D, dQ_D) =-\frac{dQ_D t_D }{2} \left[ \left( 1+ \frac{r_D^2}{4 t_D} \right) Ei \left(- \dfrac{r_D^2}{4t_D} \right) + e^{-\dfrac{r_D^2}{4t_D}} \right] $$ 
	
	где $dQ_D$ - скорость изменения дебита.
	
	Для таблично заданных дебитов и времен можно оценить 
	
	$$
	dQ_{D(i)} = \dfrac{Q_{D(i)}-Q_{D(i-1)}}{t_{D(i)} - t_{D(i-1)} } 
	$$
	
	Cравните формулу (11) с формулой (9.68) в книге Щелкачева "Основы неустановившейся фильтрации"
	
	Тогда, используя принцип суперпозиции, можем выписать выражение для изменения давления на скважине и вокруг нее для произвольного момента времени
	
	$$P_{mr.D}(t_D, r_D) = \sum_i  p_D\left(t_D-t_{D(i)}, r_D, dQ_{D(i+1)} - dQ_{D(i)}\right)\cdot \mathcal{H}(t_D-t_{D(i)}) $$
	
	где
	
	- $i$ - индекс значения дебита в таблице изменения дебитов
	
	- $dQ_{D(i)}$ - изменение безразмерного дебита относительно безразмерного времени (14.4) 
	
	- $t_{D(i)}$ - безразмерный момент времени - включения дебита с номером $i$
	
	- $t_{D}$ - безразмерный момент времени для которого проводится расчет
	
	- $\mathcal{H}$ - ступенчатая функция Хевисайда
	
	- $p_D\left(t\right)$ - зависимость безразмерного давление от времени - решение задачи запуска скважины с постоянным единичным дебитом
	
	- $P_{mr.D} $ - безразмерное давление $P_{mr.D}(t_D, r_D)$ учитывающее историю изменения дебитов скважины
	
	следует обратить внимание, при суперпозиции скорость изменения дебита вычисляется как $dQ_{D(i+1)} - dQ_{D(i)}$.  при реализации расчета необходимо предусмотреть, чтобы для первого и последнего шага расчет прошел корректно. Для этого можно, например, добавить к массивам дебитов и времени дополнительный значения в начале и в конце массивов соответствующие постоянным значениям дебита. 
	
	Также надо учитывать, что в приведенном выражении массивы должны начинаться со значений $Q_D=0$
	
	\section{Радиус влияния скважины}
	
	
	Нестационарное решение в безразмерных переменных
	$$ 
	p_D(r_D,t_D) = - \frac{1}{2} Ei \left(- \dfrac{ r_D^2}{4t_d} \right)
	$$
	где безразмерные переменные введены как
	$$ r_D = \frac{r}{r_w}  $$
	$$ t_D = \frac{0.00036 kt}{\phi \mu c_t r_w^2}  $$
	$$ p_D = \frac{kh}{ 18.41 q_s B \mu} \left( p_i - p \right)   $$
	
	Здесь использование единицы измерения СИ.
	- $r_w$ - радиус скважины, м
	
	- $r$ - расстояние от центра скважины до точки в пласте, м
	
	- $q_s$ - дебит скважины на поверхности, приведенный к нормальным условиям м3/сут
	
	- $\phi$ - пористость, доли единиц
	
	- $\mu$ - вязкость нефти в пласте, сП
	
	- $B$ - объемный коэффициент нефти, м3/м3
	
	- $p_i$ - начальное давление в пласте, атм
	
	- $p$ - давление на расстоянии $r$, атм
	
	- $c_t$ - общая сжимаемость системы в пласте, 1/атм
	
	Для этих же безразмерных переменных, считая начальное давление равным давлению на контуре можно записать стационарное решение для движения в круговом пласте
	
	$$p_D = \ln r_{eD} - \ln r_D $$
	
	сравним это решение с логарифмической аппроксимацией (1)
	
	$$p_D(r_D,t_D) = - \frac{q_D}{2} \left[ \ln \left( \dfrac{ r_D^2}{4t_d} \right) +\gamma \right] $$
	
	которое можно преобразовать к виду
	$$p_D(r_D,t_D) = - q_D \ln r_D  + \frac{q_D}{2} \left[ \ln(4t_D)   -\gamma \right] $$
	
	сравнивая со стационарным решением можно найти выражение безразмерного радиуса контура в зависимости от безразмерного времени
	$$\ln r_{eD} = \frac{1}{2}(\ln(4t_D)-\gamma) $$
	
	$$r_{eD} =  \sqrt { 4t_D e^{-\gamma} }  $$
	
	наконец получим
	$$r_{eD} = \sqrt {2.2458 t_D} $$
	
	это значение называют радиусом влияния скважины. Используя это значение для определенного момента времени можно получить стационарное распределение давления в системе хорошо приближающее решение линейного стока работающего в бесконечном пласте. Можно считать это расстояние за расстояние на которое распространяется влияние скважины.
	
	достижение радиуса влияния внешних границ будет обуславливать начало перехода от неустановившегося режима фильтрации к режиму обусловленному влиянием границ - стационарному для границы постоянного давления или псевдоустановившемуся для границы непротекания.
	
	%\insertbibliofull
	\printbibliography
\end{document}